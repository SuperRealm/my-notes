# HTML规范

## HTML/CSS文件命名

确保文件命名总是以字母开头而不是数字，且字母一律小写，以下划线连接且不带其他标点符号，如：

```html
<!-- HTML -->
jdc.html
jdc_list.html
jdc_detail.html

<!-- SASS -->
jdc.scss
jdc_list.scss
jdc_detail.scss
```

## ClassName命名

ClassName的命名应该尽量精短、明确，必须以**字母开头命名**，且**全部字母为小写**，单词之间**统一使用下划线** “_” 连接

## 命名原则

基于姓氏命名法（继承 + 外来），如下图：

![enter image description here](http://labs.qiang.it/ppguide/img/standard_jiapu.png)

祖先模块不能出现下划线，除了是全站公用模块，如 `mod_` 系列的命名：

**推荐：**

```html
<div class="modulename">
	<div class="modulename_info">
		<div class="modulename_son"></div>
		<div class="modulename_son"></div>
		...
	</div>
</div>
	
<!-- 这个是全站公用模块，祖先模块允许直接出现下划线 -->
<div class="mod_info">
	<div class="mod_info_son"></div>
	<div class="mod_info_son"></div>
	...		
</div>
```

**不推荐：**

```html
<div class="modulename_info">
	<div class="modulename_info_son"></div>
	<div class="modulename_info_son"></div>
	...		
</div>
```

在子孙模块数量可预测的情况下，严格继承祖先模块的命名前缀

```html
<div class="modulename">
	<div class="modulename_cover"></div>
	<div class="modulename_info"></div>
</div>
```

当子孙模块超过4级或以上的时候，可以考虑在祖先模块内具有识辨性的独立缩写作为新的子孙模块

**推荐：**

```html
<div class="modulename">
	<div class="modulename_cover"></div>
	<div class="modulename_info">
    	<div class="modulename_info_user">
    		<div class="modulename_info_user_img">
    			<img src="" alt="">
    			<!-- 这个时候 miui 为 modulename_info_user_img 首字母缩写-->
    			<div class="miui_tit"></div>
    			<div class="miui_txt"></div>
    			...
    		</div>
    	</div>
    	<div class="modulename_info_list"></div>
	</div>
</div>
```

**不推荐：**

```html
<div class="modulename">
	<div class="modulename_cover"></div>
	<div class="modulename_info">
    	<div class="modulename_info_user">
    		<div class="modulename_info_user_img">
    			<img src="" alt="">
    			<div class="modulename_info_user_img_tit"></div>
    			<div class="modulename_info_user_img_txt"></div>
    			...
    		</div>
    	</div>
    	<div class="modulename_info_list"></div>
	</div>
</div>
```

## 模块命名

全站公共模块：以 `mod_` 开头

```html
<div class="mod_yours"></div>
```

业务公共模块：以 `业务名_mod_` 开头

```html
<div class="paipai_mod_yours"></div>
```

## 常用命名推荐

**注意**：ad、banner、gg、guanggao 等有机会和广告挂勾的字眠不建议直接用来做ClassName，因为有些浏览器插件（Chrome的广告拦截插件等）会直接过滤这些类名，因此

```html
<div class="ad"></div>
```

这种广告的英文或拼音类名不应该出现

另外，**敏感不和谐字眼**也不应该出现，如：

```html
<div class="fuck"></div>
<div class="jer"></div>
<div class="sm"></div>
<div class="gcd"></div> 
<div class="ass"></div> 
<div class="KMT"></div> 
...
```

| ClassName              | 含义                                     |
| :--------------------- | :--------------------------------------- |
| about                  | 关于                                     |
| account                | 账户                                     |
| arrow                  | 箭头图标                                 |
| article                | 文章                                     |
| aside                  | 边栏                                     |
| audio                  | 音频                                     |
| avatar                 | 头像                                     |
| bg,background          | 背景                                     |
| bar                    | 栏（工具类）                             |
| branding               | 品牌化                                   |
| crumb,breadcrumbs      | 面包屑                                   |
| btn,button             | 按钮                                     |
| caption                | 标题，说明                               |
| category               | 分类                                     |
| chart                  | 图表                                     |
| clearfix               | 清除浮动                                 |
| close                  | 关闭                                     |
| col,column             | 列                                       |
| comment                | 评论                                     |
| community              | 社区                                     |
| container              | 容器                                     |
| content                | 内容                                     |
| copyright              | 版权                                     |
| current                | 当前态，选中态                           |
| default                | 默认                                     |
| description            | 描述                                     |
| details                | 细节                                     |
| disabled               | 不可用                                   |
| entry                  | 文章，博文                               |
| error                  | 错误                                     |
| even                   | 偶数，常用于多行列表或表格中             |
| fail                   | 失败（提示）                             |
| feature                | 专题                                     |
| fewer                  | 收起                                     |
| field                  | 用于表单的输入区域                       |
| figure                 | 图                                       |
| filter                 | 筛选                                     |
| first                  | 第一个，常用于列表中                     |
| footer                 | 页脚                                     |
| forum                  | 论坛                                     |
| gallery                | 画廊                                     |
| group                  | 模块，清除浮动                           |
| header                 | 页头                                     |
| help                   | 帮助                                     |
| hide                   | 隐藏                                     |
| hightlight             | 高亮                                     |
| home                   | 主页                                     |
| icon                   | 图标                                     |
| info,information       | 信息                                     |
| last                   | 最后一个，常用于列表中                   |
| links                  | 链接                                     |
| login                  | 登录                                     |
| logout                 | 退出                                     |
| logo                   | 标志                                     |
| main                   | 主体                                     |
| menu                   | 菜单                                     |
| meta                   | 作者、更新时间等信息栏，一般位于标题之下 |
| module                 | 模块                                     |
| more                   | 更多（展开）                             |
| msg,message            | 消息                                     |
| nav,navigation         | 导航                                     |
| next                   | 下一页                                   |
| nub                    | 小块                                     |
| odd                    | 奇数，常用于多行列表或表格中             |
| off                    | 鼠标离开                                 |
| on                     | 鼠标移过                                 |
| output                 | 输出                                     |
| pagination             | 分页                                     |
| pop,popup              | 弹窗                                     |
| preview                | 预览                                     |
| previous               | 上一页                                   |
| primary                | 主要                                     |
| progress               | 进度条                                   |
| promotion              | 促销                                     |
| rcommd,recommendations | 推荐                                     |
| reg,register           | 注册                                     |
| save                   | 保存                                     |
| search                 | 搜索                                     |
| secondary              | 次要                                     |
| section                | 区块                                     |
| selected               | 已选                                     |
| share                  | 分享                                     |
| show                   | 显示                                     |
| sidebar                | 边栏，侧栏                               |
| slide                  | 幻灯片，图片切换                         |
| sort                   | 排序                                     |
| sub                    | 次级的，子级的                           |
| submit                 | 提交                                     |
| subscribe              | 订阅                                     |
| subtitle               | 副标题                                   |
| success                | 成功（提示）                             |
| summary                | 摘要                                     |
| tab                    | 标签页                                   |
| table                  | 表格                                     |
| txt,text               | 文本                                     |
| thumbnail              | 缩略图                                   |
| time                   | 时间                                     |
| tips                   | 提示                                     |
| title                  | 标题                                     |
| video                  | 视频                                     |
| wrap                   | 容器，包，一般用于最外层                 |
| wrapper                | 容器，包，一般用于最外层                 |

## 使用正确的文档类型

文档声明位于HTML文档第一行

```html
<!DOCTYPE html>
```

## HTML书写规范

1. 标签必须合法且闭合，每个块状元素独立一行，内联元素可选

2. HTML标签名、类名、标签属性和大部分属性值统一用小写

3. HTML文本、CDATA、JavaScript、meta标签某些属性等内容可大小写混合

4. Title标签

   内容控制56字符以内

   Keywords----Keywords为产品名、专题名、专题相关名词，之间用英文半角逗号隔开

   Description----不超过150个字符，描述内容要和页面内容相关

5. 不要无缘无故添加空行

6. 为每个逻辑功能块添加空行，这样更易于阅读

7. 比较短的代码间不要使用不必要的空行和缩进

8. 冒号与属性值之间添加一个空格

9. 逗号和符号之后使用一个空格

10. 每行最多 80 个字符

11. 只有属性值包含空格时才使用引号

12. 每个属性与值结尾都要使用分号

13. 左花括号与选择器间添加一个空格

14. 将左花括号与选择器放在同一行

15. 不需要为 CSS、JS 指定类型属性，HTML5 中默认已包含

16. 在 HTML 中不能使用小于号 “<” 和大于号 “>”特殊字符，浏览器会将它们作为标签解析，若要正确显示，在 HTML 源代码中使用字符实体

17. 统一使用四个空格进行代码缩进，使得各编辑器表现一致（各编辑器有相关配置）

18. 元素属性值使用双引号语法，元素属性值可以写上的都写上

19. 纯数字输入框使用 `type="tel"` 而不是 `type="number"`

20. 标签语法无错误，需要符合语义化

21. 标签的自定义属性以`data-`开头，如：`<a href="#" data-num='18'></a>`

22. 除非有特定的功能、组件要求等，禁止随意使用id来定义元素样式

23. 空元素标签都不加 “/” 字符

## 链接

1. 给 `<a>` 标签加上title属性
2. `<a>`标签的`href`属性必须写上链接地址，点击无任何效果`javascript:void(0)`，void操作符可以设置任何输出内容
3. 非本专题的页面间跳转，采用打开新窗口模式：`target="_blank"`

## 图片属性

图片通常使用 **alt** 属性。 在图片不能显示时，它能替代图片显示。

## https协议自适应

### 缺省协议

将调用静态域名 `ossweb-img.qq.com` 以及 `game.gtimg.cn` 的外部请求，写法上一律去掉协议`http:`部分，采用自适应的写法。具体方法如下

如果当前页面使用的是 http 协议，则`//`自动识别并替换为`http://`，如果使用的是 https 协议，则`//`自动识别并替换为`https://`

**优点：**

自适应http和https协议，能根据用户打开页面的方式自动识别请求协议；
当前页面和目标资源同时支持http和https，并支持正在从http升级到https；
对于https页面的内容，浏览器默认会组织非https内容（http协议在https协议的页面里会报错），使用//可以避免这种情况。

**缺点：**

直接打开本地文件调试时，使用的协议是文件协议file://。


## flash

页面禁止使用flash，动画使用video、CSS3、canvas等方式实现，低版本浏览器使用背景图片降级。

## HTML 注释

合理的注释有助于后期维护。

注释可以写在 <!-- 和 --> 中:

较长的的HTML文件，请在板块之间加入注释，使得结构更清晰：

```html
...
<!-- 活动板块 开始 -->
<div class="part-act">
...
</div>
<!-- 活动板块 结束 -->
...
```

## 在 HTML 中载入 JavaScript

使用简洁的语法来载入外部的脚本文件 ( type 属性不是必须的 ):

# CSS规范

## 编码

- 样式文件必须写上 @charset 规则，必须在样式文件的第一行首个字符位置开始写，统一使用 “UTF-8”编码
- 字符 @charset “”; 都用小写字母，不能出现转义符，编码名允许大小混写
- 考虑到在使用“UTF-8”编码情况下 BOM 对代码的污染和编码显示的问题，在可控范围下，坚决不使用 BOM。

*推荐：*

```css
@charset "UTF-8";

.jdc{}
```

## 代码风格

### 代码格式化

样式书写一般有两种：一种是紧凑格式 (Compact)

```css
.jdc{ display: block;width: 50px;}
```

一种是展开格式（Expanded）

```css
.jdc{
    display: block;
    width: 50px;
}
```

统一使用展开格式书写样式

### 选择器

- 尽量少用通用选择器 `*`
- 不使用 ID 选择器
- 不使用无具体语义定义的标签选择器

```css
/* 推荐 */
.jdc {}
.jdc li {}
.jdc li p{}

/* 不推荐 */
*{}
#jdc {}
.jdc div{}
```

### 分号

每个属性声明末尾都要加分号；

```css
.jdc {
    width: 100%;
    height: 100%;
}
```

### 代码易读性

左括号与类名之间一个空格，冒号与属性值之间一个空格

逗号分隔的取值，逗号之后一个空格

*推荐：*

```css
.jdc {
    box-shadow: 1px 1px 1px #333, 2px 2px 2px #ccc;
}
```

为单个css选择器或新申明开启新行

*推荐：*

```css
.jdc, 
.jdc_logo, 
.jdc_hd {
    color: #ff0;
}
.nav{
    color: #fff;
}
```

颜色值 `rgb()` `rgba()` `hsl()` `hsla()` `rect()` 中不需有空格，且取值不要带有不必要的 0

*推荐：*

```css
.jdc {
    color: rgba(255,255,255,.5);
}
```

属性值十六进制数值能用简写的尽量用简写

*推荐：*

```css
.jdc {
    color: #fff;
}
```

不要为 `0` 指明单位

*推荐：*

```css
.jdc {
    margin: 0 10px;
}
```

### 属性值引号

css属性值需要用到引号时，统一使用单引号

```css
/* 推荐 */
.jdc { 
	font-family: 'Hiragino Sans GB';
}

/* 不推荐 */
.jdc { 
	font-family: "Hiragino Sans GB";
}
```

### 属性书写顺序

建议遵循以下顺序：

1. 布局定位属性：display / position / float / clear / visibility / overflow
2. 自身属性：width / height / margin / padding / border / background
3. 文本属性：color / font / text-decoration / text-align / vertical-align / white- space / break-word
4. 其他属性（CSS3）：content / cursor / border-radius / box-shadow / text-shadow / background:linear-gradient …

```css
.jdc {
    display: block;
    position: relative;
    float: left;
    width: 100px;
    height: 100px;
    margin: 0 10px;
    padding: 20px 0;
    font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;
    color: #333;
    background: rgba(0,0,0,.5);
    -webkit-border-radius: 10px;
    -moz-border-radius: 10px;
    -o-border-radius: 10px;
    -ms-border-radius: 10px;
    border-radius: 10px;
}
```

### CSS3浏览器私有前缀写法

CSS3 浏览器私有前缀在前，标准前缀在后

```css
.jdc {
    -webkit-border-radius: 10px;
    -moz-border-radius: 10px;
    -o-border-radius: 10px;
    -ms-border-radius: 10px;
    border-radius: 10px;
}
```

## 注释

#### 单行注释

注释内容第一个字符和最后一个字符都是一个空格字符，单独占一行，行与行之间相隔一行

*推荐：*

```css
/* Comment Text */
.jdc{}

/* Comment Text */
.jdc{}
```



#### 模块注释

注释内容第一个字符和最后一个字符都是一个空格字符，`/*` 与 模块信息描述占一行，多个横线分隔符`-`与`*/`占一行，行与行之间相隔两行

*推荐：*

```css
/* Module A
---------------------------------------------------------------- */
.mod_a {}


/* Module B
---------------------------------------------------------------- */
.mod_b {}
```



#### 文件信息注释

在样式文件编码声明 `@charset` 语句下面注明页面名称、作者、创建日期等信息

```css
@charset "UTF-8";
/**
 * @desc File Info
 * @author Author Name
 * @date 2015-10-10
 */
```

## 选择器

1.CSS类名规范

2.禁止层级嵌套选择器过多

3除非有特定的功能、组件要求等，禁止随意使用id来定义元素样式

4除非是样式reset需要，禁止对纯元素选择器设置特定样式，避免样式污染

## reset重置样式

**PC端**

```css
html, body, div, h1, h2, h3, h4, h5, h6, p, dl, dt, dd, ol, ul, li, fieldset, form, label, input, legend, table, caption, tbody, tfoot, thead, tr, th, td, textarea, article, aside, audio, canvas, figure, footer, header, mark, menu, nav, section, time, video { margin: 0; padding: 0; }
h1, h2, h3, h4, h5, h6 { font-size: 100%; font-weight: normal }
article, aside, dialog, figure, footer, header, hgroup, nav, section, blockquote { display: block; }
ul, ol { list-style: none; }
img { border: 0 none; vertical-align: top; }
blockquote, q { quotes: none; }
blockquote:before, blockquote:after, q:before, q:after { content: none; }
table { border-collapse: collapse; border-spacing: 0; }
strong, em, i { font-style: normal; font-weight: normal; }
ins { text-decoration: underline; }
del { text-decoration: line-through; }
mark { background: none; }
input::-ms-clear { display: none !important; }
body { font: 12px/1.5 \5FAE\8F6F\96C5\9ED1, \5B8B\4F53, "Hiragino Sans GB", STHeiti, "WenQuanYi Micro Hei", "Droid Sans Fallback", SimSun, sans-serif; background: #fff; }
a { text-decoration: none; color: #333; }
a:hover { text-decoration: underline; }
```

**移动端**

```css
* { -webkit-tap-highlight-color: transparent; outline: 0; margin: 0; padding: 0; vertical-align: baseline; }
body, h1, h2, h3, h4, h5, h6, hr, p, blockquote, dl, dt, dd, ul, ol, li, pre, form, fieldset, legend, button, input, textarea, th, td { margin: 0; padding: 0; vertical-align: baseline; }
img { border: 0 none; vertical-align: top; }
i, em { font-style: normal; }
ol, ul { list-style: none; }
input, select, button, h1, h2, h3, h4, h5, h6 { font-size: 100%; font-family: inherit; }
table { border-collapse: collapse; border-spacing: 0; }
a { text-decoration: none; color: #666; }
body { margin: 0 auto; min-width: 320px; max-width: 640px; height: 100%; font-size: 14px; font-family: -apple-system,Helvetica,sans-serif; line-height: 1.5; color: #666; -webkit-text-size-adjust: 100% !important; text-size-adjust: 100% !important; }
input[type="text"], textarea { -webkit-appearance: none; -moz-appearance: none; appearance: none; }

```

移动端页面不需要设置微软雅黑、宋体等字体，终端浏览器字体取决于设备上的系统字体。

**淘宝公共样式**

```css
body, h1, h2, h3, h4, h5, h6, hr, p, blockquote, dl, dt, dd, ul, ol, li, pre, form, fieldset, legend, button, input, textarea, th, td, a{ margin:0; padding:0; }
ul, ol { list-style:none; }
a { text-decoration:none;color:#000; }
sup { vertical-align:text-top; }
sub{ vertical-align:text-bottom; }
legend { color:#000; }
fieldset, img { border:0; }
table { border-collapse:collapse; border-spacing:0; }
.clearfix:after{content:"";display:block;visibility:hidden;clear:both;height:0;}
```

# SASS规范



## 语法选用

SASS有两种语法格式，一种是 SCSS (Sassy CSS)，另一种是缩进格式（Indented Syntax），有时称之为 Sass

考虑到 SCSS 语法对 CSS 语法友好的兼容性和扩展性，我们在使用 SASS 编写样式的时候，统一使用 SCSS 语法

严格遵守上面 “CSS规范” 中的 [“编码规范”](https://guide.aotu.io/docs/css/code.html)

更多关于 SASS 编码：[SASS Encodings](http://sass-lang.com/documentation/file.SASS_REFERENCE.html)

## SASS注释规范

SASS支持 CSS 标准的多行注释 `/* */`，同时也支持单行注释 `//`。

- 多行注释在使用非 Compressed 模式进行编译后的输出文件中会保留下来，单行注释 `//` 侧会被移除
- 多行注释和单行注释在 SASS 编译后输出的压缩 CSS 文件都会被移除
- 注释内容可以加入 SASS 变量
- 全部遵循 CSS 注释规范
- 不使用 `/*! */` 注释方式
- 注释内不放 SASS 变量

标准的注释规范如下：

```scss
@charset "UTF-8";

/**
 * @desc File Info
 * @author liqinuo
 * @date 2015-10-10
 */

/* Module A
----------------------------------------------------------------*/
.mod_a {}

/* module A logo */
.mod_a_logo {}

/* module A nav */
.mod_a_nav {}


/* Module B
----------------------------------------------------------------*/
.mod_b {}

/* module B logo */
.mod_b_logo {}

/* module B nav */
.mod_b_nav {}
```

## 嵌套规范

### 选择器嵌套

```scss
/* CSS */
.jdc {}
body .jdc {}

/* SCSS */
.jdc {
    body & {}
}
/* CSS */
.jdc {}
.jdc_cover {}
.jdc_info {}
.jdc_info_name {}

/* SCSS */
.jdc {
    &_cover {}
    &_info {
        &_name {}
    }
}
```

### 属性嵌套

```scss
/* CSS */
.jdc {
    background-color: red;
    background-repeat: no-repeat;
    background-image: url(/img/icon.png);
    background-position: 0 0;
}

/* SCSS */
.jdc {
    background: {
        color: red;
        repeat: no-repeat;
        image: url(/img/icon.png);
        position: 0 0;
    }
}
```

## 变量

可复用属性尽量抽离为页面变量，易于统一维护

```scss
// CSS
.jdc {
    color: red;
    border-color: red;
}

// SCSS
$color: red;
.jdc {
    color: $color;
    border-color: $color;
}
```

## 混合(mixin)

根据功能定义模块，然后在需要使用的地方通过 `@include` 调用，避免编码时重复输入代码段

```scss
// CSS
.jdc_1 {
    -webkit-border-radius: 5px;
    border-radius: 5px;
}
.jdc_2 {
    -webkit-border-radius: 10px;
    border-radius: 10px;
}

// SCSS
@mixin radius($radius:5px) {
    -webkit-border-radius: $radius;
    border-radius: $radius;
}
.jdc_1 {
    @include radius; //参数使用默认值
}
.jdc_2 {
    @include radius(10px);
}



// CSS
.jdc_1 {
    background: url(/img/icon.png) no-repeat -10px 0;
}
.jdc_2 {
    background: url(/img/icon.png) no-repeat -20px 0;
}

// SCSS
@mixin icon($x:0, $y:0) {
    background: url(/img/icon.png) no-repeat $x, $y;
}
.jdc_1 {
    @include icon(-10px, 0);
}
.jdc_2 {
    @include icon(-20px, 0);
}
```

## 占位选择器 %

如果不调用则不会有任何多余的 css 文件，占位选择器以 `%` 标识定义，通过 `@extend` 调用

```scss
//scss
%borderbox {
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
}
.jdc {
    @extend %borderbox;
}
```

## extend 继承

```scss
// CSS
.jdc_1 {
    font-size: 12px;
    color: red;
}
.jdc_2 {
    font-size: 12px;
    color: red;
    font-weight: bold;
}

// SCSS
.jdc_1 {
    font-size: 12px;
    color: red;
}
.jdc_2 {
    @extend .jdc_1;
    font-weight: bold;
}

// 或者
%font_red {
    font-size: 12px;
    color: red;
}
.jdc_1 {
    @extend %font_red;
}
.jdc_2 {
    @extend %font_red;
    font-weight: bold;
}
```

## for 循环

```scss
// CSS
.jdc_1 {background-position: 0 -20px;}
.jdc_2 {background-position: 0 -40px;}
.jdc_3 {background-position: 0 -60px;}

// SCSS
@for $i from 1 through 3 {
    .jdc_#{$i} {
        background-position: 0 (-20px) * $i;
    }
}
```

注意：`#{}` 是连接符，变量连接使用时需要依赖

## each 循环

```scss
// CSS
.jdc_list {
    background-image: url(/img/jdc_list.png);
}
.jdc_detail {
    background-image: url(/img/jdc_detail.png);
}

// SCSS
@each $name in list, detail {
    .jdc_#{$name} {
        background-image: url(/img/jdc_#{$name}.png);
    }
}


// CSS
.jdc_list {
    background-image: url(/img/jdc_list.png);
    background-color: red;
}
.jdc_detail {
    background-image: url(/img/jdc_detail.png);
    background-color: blue;
}

// SCSS
@each $name, $color in (list, red), (detail, blue) {
    .jdc_#{$name} {
        background-image: url(/img/jdc_#{$name}.png);
        background-color: $color;
    }
}
```

## function 函数

```scss
@function pxToRem($px) {
    @return $px / 10px * 1rem;
}
.jdc {
    font-size: pxToRem(12px);
}
```

## 运算规范

运算符之间空出一个空格

```scss
.jdc {
    width: 100px - 50px;
    height: 30px / 5;
}
```

注意运算单位，单位同时参与运算，所以 10px 不等于 10，乘除运算时需要特别注意

```scss
// 正确的运算格式
.jdc {
    width: 100px - 50px;
    width: 100px + 50px;
    width: 100px * 2;
    width: 100px / 2;
}
```

# JS规范

## 语言规范

JavaScript 是一种客户端脚本语言，这里列出了编写 JavaScript 时需要遵守的规则。

### 类型

- 原始类型: 存取原始类型直接作用于值本身

  - 布尔类型
  - Null 类型
  - Undefined 类型
  - 数字类型
  - BigInt 类型
  - 字符串类型
  - 符号类型 Symbol

  ```js
  const foo = 1
  let bar = foo
  
  bar = 9
  
  console.log(foo, bar) // 1, 9
  ```

- 复杂类型: 访问复杂类型作用于值的引用

  - object
  - array
  - function

  ```js
  const foo = [1, 2, 3]
  const bar = foo
  
  bar[0] = 9
  
  console.log(foo[0], bar[0]) // 9, 9
  ```

### 引用

- 请记得 `const` 和 `let` 都是块级作用域，`var` 是函数级作用域

```js
// const and let only exist in the blocks they are defined in.
{
  let a = 1
  const b = 1
}
console.log(a) // ReferenceError
console.log(b) // ReferenceError
```

- 对所有引用都使用 `const`，不要使用 `var`，eslint: [prefer-const](https://eslint.org/docs/rules/prefer-const.html), [no-const-assign](https://eslint.org/docs/rules/no-const-assign.html)

> 原因：这样做可以确保你无法重新分配引用，以避免出现错误和难以理解的代码

```js
// bad
var a = 1
var b = 2

// good
const a = 1
const b = 2
```

- 如果引用是可变动的，使用 `let` 代替 `var`，eslint: [no-var](https://eslint.org/docs/rules/no-var.html)

> 原因：`let` 是块级作用域的，而不像 `var` 属于函数级作用域

```js
// bad
var count = 1
if (count < 10) {
  count += 1
}

// good
let count = 1
if (count < 10) {
  count += 1
}
```

### 对象

- 请使用字面量值创建对象，eslint: [no-new-object](https://eslint.org/docs/rules/no-new-object.html)

  ```js
  // bad
  const a = new Object{}
  
  // good
  const a = {}
  ```

- 别使用保留字作为对象的键值，这样在 IE8 下不会运行

  ```js
  // bad
  const a = {
    default: {},  // default 是保留字
    common: {}
  }
  
  // good
  const a = {
    defaults: {},
    common: {}
  }
  ```

- 当使用动态属性名创建对象时，请使用对象计算属性名来进行创建

> 原因：因为这样做就可以让你在一个地方定义所有的对象属性

```js
function getKey(k) {
  return `a key named ${k}`
}

// bad
const obj = {
  id: 5,
  name: 'San Francisco'
};
obj[getKey('enabled')] = true

// good
const obj = {
  id: 5,
  name: 'San Francisco',
  [getKey('enabled')]: true
};
```

- 请使用对象方法的简写方式，eslint: [object-shorthand](https://eslint.org/docs/rules/object-shorthand.html)

  ```js
  // bad
  const item = {
    value: 1,
  
    addValue: function (val) {
      return item.value + val
    }
  }
  
  // good
  const item = {
    value: 1,
  
    addValue (val) {
      return item.value + val
    }
  }
  ```

- 请使用对象属性值的简写方式，eslint: [object-shorthand](https://eslint.org/docs/rules/object-shorthand.html)

  > 原因：这样更简短且描述更清楚

  ```js
  const job = 'FrontEnd'
  
  // bad
  const item = {
    job: job
  }
  
  // good
  const item = {
    job
  }
  ```

- 将简写的对象属性分组后统一放到对象声明的开头

> 原因：这样更容易区分哪些属性用了简写的方式

```js
const job = 'FrontEnd'
const department = 'JDC'

// bad
const item = {
  sex: 'male',
  job,
  age: 25,
  department
}

// good
const item = {
  job,
  department,
  sex: 'male',
  age: 25
}
```

- 只对非法标识符的属性使用引号，eslint: [quote-props](https://eslint.org/docs/rules/quote-props.html)

> 原因：因为通常来说我们认为这样主观上会更容易阅读，这样会带来代码高亮上的提升，同时也更容易被主流 JS 引擎优化

```js
// bad
const bad = {
  'foo': 3,
  'bar': 4,
  'data-blah': 5
}

// good
const good = {
  foo: 3,
  bar: 4,
  'data-blah': 5
}
```

- 不要直接使用

   

  ```js
  Object.prototype
  ```

   

  的方法, 例如

   

  ```js
  hasOwnProperty
  ```

  ,

   

  ```js
  propertyIsEnumerable
  ```

   

  和

   

  ```js
  isPrototypeOf
  ```

   

  方法，eslint:

   

  no-prototype-builtins

  > 原因：这些方法可能会被对象自身的同名属性覆盖 - 比如 `{ hasOwnProperty: false }` 或者对象可能是一个 `null` 对象(`Object.create(null)`)

```js
// bad
console.log(object.hasOwnProperty(key))

// good
console.log(Object.prototype.hasOwnProperty.call(object, key))

// best
const has = Object.prototype.hasOwnProperty // cache the lookup once, in module scope.
console.log(has.call(object, key))
/* or */
import has from 'has' // https://www.npmjs.com/package/has
console.log(has(object, key))
```

- 优先使用对象展开运算符 `...` 来做对象浅拷贝而不是使用 `Object.assign`，使用对象剩余操作符来获得一个包含确定的剩余属性的新对象

```js
// very bad
const original = { a: 1, b: 2 }
const copy = Object.assign(original, { c: 3 }) // this mutates `original` ಠ_ಠ
delete copy.a // so does this

// bad
const original = { a: 1, b: 2 }
const copy = Object.assign({}, original, { c: 3 }) // copy => { a: 1, b: 2, c: 3 }

// good
const original = { a: 1, b: 2 }
const copy = { ...original, c: 3 } // copy => { a: 1, b: 2, c: 3 }

const { a, ...noA } = copy // noA => { b: 2, c: 3 }
```

### 数组

- 请使用字面量值创建数组，eslint: [no-array-constructor](https://eslint.org/docs/rules/no-array-constructor.html)

  ```js
  // bad
  const items = new Array()
  
  // good
  const items = []
  ```

- 向数组中添加元素时，请使用 `push` 方法

  ```js
  const items = []
  
  // bad
  items[items.length] = 'test'
  
  // good
  items.push('test')
  ```

- 使用展开运算符 `...` 复制数组

  ```js
  // bad
  const items = []
  const itemsCopy = []
  const len = items.length
  let i
  
  // bad
  for (i = 0; i < len; i++) {
    itemsCopy[i] = items[i]
  }
  
  // good
  itemsCopy = [...items]
  ```

- 把一个可迭代的对象转换为数组时，使用展开运算符 `...` 而不是 `Array.from`

```js
const foo = document.querySelectorAll('.foo')

// good
const nodes = Array.from(foo)

// best
const nodes = [...foo]
```

- 使用 `Array.from` 来将一个类数组对象转换为数组

```js
const arrLike = { 0: 'foo', 1: 'bar', 2: 'baz', length: 3 }

// bad
const arr = Array.prototype.slice.call(arrLike)

// good
const arr = Array.from(arrLike)
```

- 遍历迭代器进行映射时使用 `Array.from` 代替扩展运算符 `...`, 因为这可以避免创建中间数组

```js
// bad
const baz = [...foo].map(bar)

// good
const baz = Array.from(foo, bar)
```

- 使用数组的 `map` 等方法时，请使用 `return` 声明，如果是单一声明语句的情况，可省略 `return`

  ```js
  // good
  [1, 2, 3].map(x => {
    const y = x + 1
    return x * y
  })
  
  // good
  [1, 2, 3].map(x => x + 1)
  
  // bad
  const flat = {}
  [[0, 1], [2, 3], [4, 5]].reduce((memo, item, index) => {
    const flatten = memo.concat(item)
    flat[index] = flatten
  })
  
  // good
  const flat = {}
  [[0, 1], [2, 3], [4, 5]].reduce((memo, item, index) => {
    const flatten = memo.concat(item)
    flat[index] = flatten
    return flatten
  })
  
  // bad
  inbox.filter((msg) => {
    const { subject, author } = msg
    if (subject === 'Mockingbird') {
      return author === 'Harper Lee'
    } else {
      return false
    }
  })
  
  // good
  inbox.filter((msg) => {
    const { subject, author } = msg
    if (subject === 'Mockingbird') {
      return author === 'Harper Lee'
    }
  
    return false
  })
  ```

- 如果一个数组有多行则要在数组的开括号后和闭括号前使用新行

```js
// bad
const arr = [
  [0, 1], [2, 3], [4, 5]
]

const objectInArray = [{
  id: 1
}, {
  id: 2
}]

const numberInArray = [
  1, 2
]

// good
const arr = [[0, 1], [2, 3], [4, 5]]

const objectInArray = [
  {
    id: 1
  },
  {
    id: 2
  }
]

const numberInArray = [
  1,
  2
]
```

### 解构赋值

- 当需要使用对象的多个属性时，请使用解构赋值，eslint: [prefer-destructuring](https://eslint.org/docs/rules/prefer-destructuring)

> 愿意：解构可以避免创建属性的临时引用

```js
// bad
function getFullName (user) {
  const firstName = user.firstName
  const lastName = user.lastName

  return `${firstName} ${lastName}`
}

// good
function getFullName (user) {
  const { firstName, lastName } = user

  return `${firstName} ${lastName}`
}

// better
function getFullName ({ firstName, lastName }) {
  return `${firstName} ${lastName}`
}
```

- 当需要使用数组的多个值时，请同样使用解构赋值，eslint: [prefer-destructuring](https://eslint.org/docs/rules/prefer-destructuring)

  ```js
  const arr = [1, 2, 3, 4]
  
  // bad
  const first = arr[0]
  const second = arr[1]
  
  // good
  const [first, second] = arr
  ```

- 函数需要回传多个值时，请使用对象的解构，而不是数组的解构

> 原因：可以非破坏性地随时增加或者改变属性顺序

```js
// bad
function doSomething () {
  return [top, right, bottom, left]
}

// 如果是数组解构，那么在调用时就需要考虑数据的顺序
const [top, xx, xxx, left] = doSomething()

// good
function doSomething () {
  return { top, right, bottom, left }
}

// 此时不需要考虑数据的顺序
const { top, left } = doSomething()
```

### 字符串

- 字符串统一使用单引号的形式 `''`，eslint: [quotes](https://eslint.org/docs/rules/quotes.html)

  ```js
  // bad
  const department = "JDC"
  
  // good
  const department = 'JDC'
  ```

- 字符串太长的时候，请不要使用字符串连接符换行 `\`，而是使用 `+`

  ```js
  const str = '凹凸实验室 凹凸实验室 凹凸实验室' +
    '凹凸实验室 凹凸实验室 凹凸实验室' +
    '凹凸实验室 凹凸实验室'
  ```

- 程序化生成字符串时，请使用模板字符串，eslint: [prefer-template](http://eslint.org/docs/rules/prefer-template.html) [template-curly-spacing](https://eslint.org/docs/rules/template-curly-spacing)

  ```js
  const test = 'test'
  
  // bad
  const str = ['a', 'b', test].join()
  
  // bad
  const str = 'a' + 'b' + test
  
  // good
  const str = `ab${test}`
  ```

- 不要对字符串使用eval()，会导致太多漏洞， eslint: [no-eval](https://eslint.org/docs/rules/no-eval)

- 不要在字符串中使用不必要的转义字符， eslint: [no-useless-escape](https://eslint.org/docs/rules/no-useless-escape)

```js
// bad
const foo = '\'this\' \i\s \"quoted\"'

// good
const foo = '\'this\' is "quoted"'
const foo = `my name is '${name}'`
```

### 函数

- 不要使用Function构造函数创建函数， eslint: [no-new-func](https://eslint.org/docs/rules/no-new-func)

> 原因：此方式创建函数和对字符串使用 `eval()` 一样会产生漏洞

```js
// bad
const add = new Function('a', 'b', 'return a + b')

// still bad
const subtract = Function('a', 'b', 'return a - b')
```

- 在函数签名中使用空格，eslint: [space-before-function-paren](https://eslint.org/docs/rules/space-before-function-paren) [space-before-blocks](https://eslint.org/docs/rules/space-before-blocks)

```js
const f = function(){}
const g = function (){}
const h = function() {}

// good
const x = function b () {}
const y = function a () {}
```

- 使用具名函数表达式而非函数声明，eslint: [func-style](http://eslint.org/docs/rules/func-style)

> 原因：这样做会导致函数声明被提升，这意味着很容易在文件中定义此函数之前引用它，不利于可读性和可维护性。如果你发现函数定义既庞大又复杂以至于不能理解文件的其他部分，或许你应该将它拆分成模块！别忘记要显式命名表达式，而不用管名字是否是从包含的变量（通常出现在现代浏览器中或者使用 Babel 编译器的时候）中推断的。这样会消除错误调用堆栈中的任何假设。 (讨论)

```js
// bad
function foo () {
  // ...
}

// bad
const foo = function () {
  // ...
}

// good
// lexical name distinguished from the variable-referenced invocation(s)
const short = function longUniqueMoreDescriptiveLexicalFoo () {
  // ...
}
```

- 用圆括号包裹自执行匿名函数，eslint：[wrap-iife](http://eslint.org/docs/rules/wrap-iife.html)

> 原因：一个立即执行匿名函数表达式是一个单一的单元，将其及其调用括号包装在括号中，能够清楚地表达这一点。注意，在到处都是模块的世界中几乎不需要 IIFE。

```js
// immediately-invoked function expression (IIFE)
(function () {
  console.log('Welcome to the Internet. Please follow me.')
}())
```

- 不要在非函数代码块（`if` , `while` 等）中声明函数，eslint：[no-loop-func](http://eslint.org/docs/rules/no-loop-func.html)

  ```js
  // bad
  if (isUse) {
    function test () {
      // do something
    }
  }
  
  // good
  let test
  if (isUse) {
    test = () => {
      // do something
    }
  }
  ```

- 不要将参数命名为 `arguments`，会导致该参数的优先级高于每个函数作用域内原先存在的 `arguments` 对象

```js
// bad
function foo (name, options, arguments) {
  // ...
}

// good
function foo (name, options, args) {
  // ...
}
```

- 不要使用 `arguments`，使用 剩余运算符 `...`

  > `arguments` 只是一个类数组，而 `...` 是一个真正的数组

  ```js
  // bad
  function test () {
    const args = Array.prototype.slice.call(arguments)
    return args.join('')
  }
  
  // good
  function test (...args) {
    return args.join('')
  }
  ```

- 使用参数默认值语法而不是修改函数参数

```js
// really bad
function handleThings (opts) {
  // No! We shouldn't mutate function arguments.
  // Double bad: if opts is falsy it'll be set to an object which may
  // be what you want but it can introduce subtle bugs.
  opts = opts || {}
  // ...
}

// still bad
function handleThings (opts) {
  if (opts === void 0) {
    opts = {}
  }
  // ...
}

// good
function handleThings (opts = { }) {
  // ...
}
```

- 避免参数默认值的副作用

```js
let b = 1
// bad
function count (a = b++) {
  console.log(a)
}
count()  // 1
count()  // 2
count(3) // 3
count()  // 3
```

- 将参数默认值放在最后

```js
// bad
function handleThings (opts = {}, name) {
  // ...
}

// good
function handleThings (name, opts = {}) {
  // ...
}
```

- 不要更改参数，eslint: [no-param-reassign](https://eslint.org/docs/rules/no-param-reassign.html)

> 原因：操作作为参数传入的对象可能在原始调用中造成意想不到的变量副作用

```js
// bad
function f1 (obj) {
  obj.key = 1
}

// good
function f2 (obj) {
  const key = Object.prototype.hasOwnProperty.call(obj, 'key') ? obj.key : 1
}
```

- 不要给参数重新赋值，eslint: [no-param-reassign](https://eslint.org/docs/rules/no-param-reassign.html)

> 原因：参数重新赋值可能会导致无法预期的行为，尤其是当操作 `arguments` 对象时，也可能导致优化问题，尤其是在 V8 引擎中

```js
// bad
function f1 (a) {
  a = 1
}

function f2 (a) {
  if (!a) { a = 1 }
}

// good
function f3 (a) {
  const b = a || 1
}

function f4 (a = 1) {
}
```

- 调用可变参数函数时建议使用展开运算符 `....`， eslint: [prefer-spread](http://eslint.org/docs/rules/prefer-spread)

> 原因：显然你无需使用上下文，很难结合 `new` 和 `apply`

```js
// bad
const x = [1, 2, 3, 4, 5]
console.log.apply(console, x)

// good
const x = [1, 2, 3, 4, 5]
console.log(...x)

// bad
new (Function.prototype.bind.apply(Date, [null, 2016, 8, 5]))

// good
new Date(...[2016, 8, 5])
```

### 箭头函数

- 当你必须使用函数表达式（传递匿名函数）时，使用箭头函数标记. eslint: [prefer-arrow-callback](http://eslint.org/docs/rules/prefer-arrow-callback.html), [arrow-spacing](https://eslint.org/docs/rules/arrow-spacing.html)

> 原因：它将创建在 `this` 上下文中执行的函数版本，通常是您想要的，并且语法更简洁

> 如果您有一个相当复杂的函数，则可以将该逻辑移到其自己的命名函数表达式中

```js
// bad
[1, 2, 3].map(function (x) {
  const y = x + 1
  return x * y
})

// good
[1, 2, 3].map((x) => {
  const y = x + 1
  return x * y
})
```

- 如果函数体只包含一条没有副作用的返回表达式的语句，可以省略花括号并使用隐式的 `return`， 否则保留花括号并使用 `return` 语句，eslint: [arrow-parens](https://eslint.org/docs/rules/arrow-parens.html), [arrow-body-style](https://eslint.org/docs/rules/arrow-body-style.html)

```js
// bad
[1, 2, 3].map(number => {
  const nextNumber = number + 1
  `A string containing the ${nextNumber}.`
})

// good
[1, 2, 3].map(number => `A string containing the ${number}.`)

// good
[1, 2, 3].map((number) => {
  const nextNumber = number + 1
  return `A string containing the ${nextNumber}.`
})

// good
[1, 2, 3].map((number, index) => ({
  index: number
}))

// No implicit return with side effects
function foo(callback) {
  const val = callback()
  if (val === true) {
    // Do something if callback returns true
  }
}

let bool = false

// bad
foo(() => bool = true)

// good
foo(() => {
  bool = true
})
```

- 一旦表达式跨多行，使用圆括号包裹以便更好阅读

```js
// bad
['get', 'post', 'put'].map(httpMethod => Object.prototype.hasOwnProperty.call(
    httpMagicObjectWithAVeryLongName,
    httpMethod
  )
)

// good
['get', 'post', 'put'].map(httpMethod => (
  Object.prototype.hasOwnProperty.call(
    httpMagicObjectWithAVeryLongName,
    httpMethod
  )
))
```

- 函数如果只接收一个参数并且没使用用花括号，则省略圆括号，否则为了清晰明确则使用圆括号包裹参数，注意：总是使用圆括号也是可以接受的，eslint 中的 [“always” 选项](https://eslint.org/docs/rules/arrow-parens#always)，eslint: [arrow-parens](http://eslint.org/docs/rules/arrow-parens.html)

```js
// bad
[1, 2, 3].map((x) => x * x)

// good
[1, 2, 3].map(x => x * x)

// good
[1, 2, 3].map(number => (
  `A long string with the ${number}. It’s so long that we’ve broken it ` +
  'over multiple lines!'
))

// bad
[1, 2, 3].map(x => {
  const y = x + 1
  return x * y
})

// good
[1, 2, 3].map((x) => {
  const y = x + 1
  return x * y
})
```

### 类&构造函数

- 使用 `class`，避免直接操作 `prototype`

  ```js
  // bad
  function Queue (contents = []) {
    this._queue = [..contents]
  }
  Queue.prototype.pop = function () {
    const value = this._queue[0]
    this._queue.splice(0, 1)
    return value
  }
  
  // good
  class Queue {
    constructor (contents = []) {
      this._queue = [...contents]
    }
  
    pop () {
      const value = this._queue[0]
      this._queue.splice(0, 1)
      return value
    }
  }
  ```

- 使用 `extends` 来实现继承

> 原因：这是一个不会破坏 `instanceof` 的内建实现原型式继承的方式

```js
// bad
const inherits = require('inherits')
function PeekableQueue(contents) {
  Queue.apply(this, contents)
}
inherits(PeekableQueue, Queue)
PeekableQueue.prototype.peek = function () {
  return this.queue[0]
}

// good
class PeekableQueue extends Queue {
  peek () {
    return this.queue[0]
  }
}
```

- 如果未声明构造函数，则类会有一个默认的构造函数，没必要用空的构造函数或者将其委托给父类，eslint: [no-useless-constructor](http://eslint.org/docs/rules/no-useless-constructor)

```js
// bad
class Jedi {
  constructor () {}

  getName() {
    return this.name
  }
}

// bad
class Rey extends Jedi {
  constructor (...args) {
    super(...args)
  }
}

// good
class Rey extends Jedi {
  constructor (...args) {
    super(...args)
    this.name = 'Rey'
  }
}
```

- 避免类成员重复，eslint: [no-dupe-class-members](https://eslint.org/docs/rules/no-dupe-class-members)

> 原因：重复的类成员声明会默认使用最后声明的，通常会导致 bug

```js
// bad
class Foo {
  bar () { return 1 }
  bar () { return 2 }
}

// good
class Foo {
  bar () { return 1 }
}

// good
class Foo {
  bar () { return 2 }
}
```

### 模块

- 使用标准的 ES6 模块语法 `import` 和 `export`

> 原因：模块是未来，让我们现在开始使用未来的特性

```js
// bad
const util = require('./util')
module.exports = util

// good
import Util from './util'
export default Util

// better
import { Util } from './util'
export default Util
```

- 不要使用 `import` 的通配符 `*`，这样可以确保你只有一个默认的 export

  ```js
  // bad
  import * as Util from './util'
  
  // good
  import Util from './util'
  ```

- 同个文件每个模块只允许 `import` 一次，有多个 `import` 请书写在一起，eslint: [no-duplicate-imports](https://eslint.org/docs/rules/no-duplicate-imports)

> 原因：这样可以让代码更易于维护

```js
// bad
import foo from 'foo'
// … some other imports … //
import { named1, named2 } from 'foo'

// good
import foo, { named1, named2 } from 'foo'

// good
import foo, {
  named1,
  named2
} from 'foo'
```

- 将所有 `import` 语句放在文件最前方，eslint: [import/imports-first](https://github.com/benmosher/eslint-plugin-import/blob/master/docs/rules/first.md)

```js
// bad
import foo from 'foo'
foo.init()

import bar from 'bar'

// good
import foo from 'foo'
import bar from 'bar'

foo.init()
```

- 多行导入应该像多行数组和对象文字一样缩进

```js
// bad
import { longNameA, longNameB, longNameC, longNameD, longNameE } from 'path'

// good
import {
  longNameA,
  longNameB,
  longNameC,
  longNameD,
  longNameE
} from 'path'
```

- 在模块 `import` 声明中禁止使用 `Webpack` 的 `loader` 语法，eslint: [import/no-webpack-loader-syntax](https://github.com/benmosher/eslint-plugin-import/blob/master/docs/rules/no-webpack-loader-syntax.md)

```js
// bad
import fooSass from 'css!sass!foo.scss'
import barCss from 'style!css!bar.css'

// good
import fooSass from 'foo.scss'
import barCss from 'bar.css'
```

### 迭代器

- 不要使用 `iterators`，建议使用 JS 更高优先级的函数代替 for-in 或 for-of 循环，除非迫不得已，eslint: [no-iterator](https://eslint.org/docs/rules/no-iterator.html) [no-restricted-syntax](https://eslint.org/docs/rules/no-restricted-syntax)

> 

```js
const numbers = [1, 2, 3, 4, 5]

// bad
let sum = 0
for (let num of numbers) {
  sum += num
}

// good
let sum = 0
numbers.forEach(num => sum += num)

// better
const sum = numbers.reduce((total, num) => total + num, 0)
```

### 生成器

- 现阶段请不要使用生成器 `generator`

> 原因：因为不能很好地翻译成 ES5 代码

### 对象属性

- 使用 `.` 来访问对象属性

  ```js
  const joke = {
    name: 'haha',
    age: 28
  }
  
  // bad
  const name = joke['name']
  
  // good
  const name = joke.name
  ```

- 当访问的属性是变量时使用 `[]`

```js
const luke = {
  jedi: true,
  age: 28,
}

function getProp (prop) {
  return luke[prop]
}

const isJedi = getProp('jedi')
```

### 变量声明

- 声明变量时，请使用 `const`、`let` 关键字，如果没有写关键字，变量就会暴露在全局上下文中，这样很可能会和现有变量冲突，另外，也很难明确该变量的作用域是什么。这里推荐使用 `const` 来声明变量，我们需要避免全局命名空间的污染。eslint: [no-undef](http://eslint.org/docs/rules/no-undef) [prefer-const](http://eslint.org/docs/rules/prefer-const)

  ```js
  // bad
  demo = new Demo()
  
  // good
  const demo = new Demo()
  ```

- 将所有的 `const` 和 `let` 分组

  ```js
  // bad
  let a
  const b
  let c
  const d
  let e
  
  // good
  const b
  const d
  let a
  let c
  let e
  ```

- 变量不要进行链式赋值

> 原因：变量链式赋值会创建隐藏的全局变量

```js
// bad
(function example() {
  // JavaScript interprets this as
  // let a = ( b = ( c = 1 ) );
  // The let keyword only applies to variable a; variables b and c become
  // global variables.
  let a = b = c = 1
}())

console.log(a) // throws ReferenceError
console.log(b) // 1
console.log(c) // 1

// good
(function example() {
  let a = 1
  let b = a
  let c = a
}())

console.log(a) // throws ReferenceError
console.log(b) // throws ReferenceError
console.log(c) // throws ReferenceError

// the same applies for `const`
```

- 不允许出现未被使用的变量，eslint: [no-unused-vars](https://eslint.org/docs/rules/no-unused-vars)

> 原因：声明但未被使用的变量通常是不完全重构犯下的错误.这种变量在代码里浪费空间并会给读者造成困扰

```js
// bad

var some_unused_var = 42

// Write-only variables are not considered as used.
var y = 10
y = 5

// A read for a modification of itself is not considered as used.
var z = 0
z = z + 1

// Unused function arguments.
function getX (x, y) {
  return x
}

// good

function getXPlusY (x, y) {
  return x + y
}

const x = 1
const y = a + 2

alert(getXPlusY(x, y))

// 'type' is ignored even if unused because it has a rest property sibling.
// This is a form of extracting an object that omits the specified keys.
const { type, ...coords } = data
// 'coords' is now the 'data' object without its 'type' property.
```

### Hoisting

- `var` 存在变量提升的情况，即 `var` 声明会被提升至该作用域的顶部，但是他们的赋值并不会。而 `const` 和 `let` 并不存在这种情况，他们被赋予了 [Temporal Dead Zones, TDZ](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let#Temporal_dead_zone_and_errors_with_let)， 了解 [typeof 不再安全](http://es-discourse.com/t/why-typeof-is-no-longer-safe/15)很重要

  ```js
  function example () {
    console.log(notDefined)   // => throws a ReferenceError
  }
  
  function example () {
    console.log(declareButNotAssigned)  // => undefined
    var declaredButNotAssigned = true
  }
  
  function example () {
    let declaredButNotAssigned
    console.log(declaredButNotAssigned)   // => undefined
    declaredButNotAssigned = true
  }
  
  function example () {
    console.log(declaredButNotAssigned)   // => throws a ReferenceError
    console.log(typeof declaredButNotAssigned)  // => throws a ReferenceError
    const declaredButNotAssigned = true
  }
  ```

- 匿名函数的变量名会提升，但函数内容不会

  ```js
  function example () {
    console.log(anonymous)  // => undefined
  
    anonymous()
  
    var anonymous = function () {
      console.log('test')
    }
  }
  ```

- 命名的函数表达式的变量名会被提升，但函数名和函数函数内容并不会

  ```js
  function example() {
    console.log(named)  // => undefined
  
    named()   // => TypeError named is not a function
  
    superPower()  // => ReferenceError superPower is not defined
  
    var named = function superPower () {
      console.log('Flying')
    }
  }
  
  function example() {
    console.log(named)  // => undefined
  
    named()   // => TypeError named is not a function
  
    var named = function named () {
      console.log('named')
    }
  }
  ```

### 比较运算符&相等

- 使用 `===` 和 `!==` 而非 `==` 和 `!=`，eslint: [eqeqeq](https://eslint.org/docs/rules/eqeqeq.html)

- 条件声明例如 `if` 会用 `ToBoolean` 这个抽象方法将表达式转成布尔值并遵循如下规则

  - `Objects` 等于 `true`

  - `Undefined` 等于 `false`

  - `Null` 等于 `false`

  - `Booleans` 等于 `布尔值`

  - `Numbers` 在 `+0`, `-0`, 或者 `NaN` 的情况下等于 `false`, 其他情况是 `true`

  - ```js
    Strings
    ```

     

    为

     

    ```js
    ''
    ```

     

    时等于

     

    ```js
    false
    ```

    , 否则是

     

    ```
    true
    ```

    ```js
    if ([0] && []) {
      // true
      // 数组(即使是空数组)也是对象，对象等于true
    }
    ```

### 分号

- 我们遵循 `Standard` 的规范，不使用分号。

  > 关于应不应该使用分号的讨论有很多，本规范认为非必要的时候，应该不使用分号，好的 `JS` 程序员应该清楚场景下是一定要加分号的，相信你也是名好的开发者。

  ```js
  // bad
  const test = 'good';
  (function () {
    const str = 'hahaha';
  })()
  
  // good
  const test = 'good'
  ;(() => {
    const str = 'hahaha'
  })();
  ```

### 标准特性

为了代码的可移植性和兼容性，我们应该最大化的使用标准方法，例如优先使用 `string.charAt(3)` 而不是 `string[3]`

### eval()

由于 `eval` 方法比较 `evil`，所以我们约定禁止使用该方法

### with() {}

由于 `with` 方法会产生神奇的作用域，所以我们也是禁止使用该方法的

### 修改内置对象的原型

不要修改内置对象，如 `Object` 和 `Array`



## 编码规范

统一团队的编码规范，有助于代码的维护。本章是传统意义上的 `Style Guideline`，目的是统一一些相对主观化的代码风格。

### 单行代码块

在单行代码块中使用空格

*不推荐*

```js
function foo () {return true}
if (foo) {bar = 0}
```

*推荐*

```js
function foo () { return true }
if (foo) { bar = 0 }
```

### 大括号风格

在编程过程中，大括号风格与缩进风格紧密联系，用来描述大括号相对代码块位置的方法有很多。在 JavaScript 中，主要有三种风格，如下：

- **One True Brace Style**

  ```js
  if (foo) {
    bar()
  } else {
    baz()
  }
  ```

- **Stroustrup**

  ```js
  if (foo) {
    bar()
  }
  else {
    baz()
  }
  ```

- **Allman**

  ```js
  if (foo)
  {
    bar()
  }
  else
  {
    baz()
  }
  ```

我们团队约定使用 `One True Brace Style` 风格

### 变量命名

当命名变量时，主流分为驼峰式命名（constiableName）和下划线命名（constiable_name）两大阵营。

> 团队约定使用驼峰式命名

### 拖尾逗号

在 ECMAScript5 里面，对象字面量中的拖尾逗号是合法的，但在 IE8（非 IE8 文档模式）下，当出现拖尾逗号，则会抛出错误。

拖尾逗号的例子：

```js
const foo = {
  name: 'foo',
  age: '22',
}
```

拖尾逗号的好处是，简化了对象和数组添加或删除元素，我们只需要修改新增的行即可，并不会增加差异化的代码行数。

> 因为拖尾逗号有好也有不好，所以团队约定允许在最后一个元素或属性与闭括号 `]` 或 `}` 在不同行时，可以（但不要求）使用拖尾逗号。当在同一行时，禁止使用拖尾逗号。

### 逗号空格

逗号前后的空格可以提高代码的可读性，团队约定在逗号后面使用空格，逗号前面不加空格。

*不推荐*

```js
const foo = 1,bar = 2
const foo = 1 , bar = 2
const foo = 1 ,bar = 2
```

*推荐*

```js
const foo = 1, bar = 2
```

### 逗号风格

逗号分隔列表时，在 JavaScript 中主要有两种逗号风格：

- 标准风格，逗号放置在当前行的末尾
- 逗号前置风格，逗号放置在下一行的开始位置

> 团队约定使用标准风格

*不推荐*

```js
const foo = 1
,
bar = 2

const foo = 1
, bar = 2

const foo = ['name'
          , 'age']
```

*推荐*

```js
const foo = 1,
    bar = 2

const foo = ['name',
            'age']
```

### 计算属性的空格

团队约定在对象的计算属性内，禁止使用空格

*不推荐*

```js
obj['foo' ]
obj[ 'foo']
obj[ 'foo' ]
```

*推荐*

```js
obj['foo']
```

### 拖尾换行

在非空文件中，存在拖尾换行是一个常见的 `UNIX` 风格，它的好处是可以方便在串联和追加文件时不会打断 `Shell` 的提示。在日常的项目中，保留拖尾换行的好处是，可以减少版本控制时的代码冲突。

*不推荐*

```js
function func () {
  // do something
}
```

*推荐*

```js
function func () {
  // do something
}
  // 此处是新的一行
```

> 可以通过 .editorconfig 添加 EOL

### 函数调用

为了避免语法错误，团队约定在函数调用时，禁止使用空格

*不推荐*

```js
fn ()
fn
()
```

*推荐*

```js
fn()
```

### 缩进

代码保持一致的缩进，是作为工程师的职业素养。但缩进用两个空格，还是四个空格，是用 `Tab` 还是空格呢？这样的争论太多了，也得不出答案。本规范结合了市面上优秀的开源项目，姑且约定使用 `空格` 来缩进，而且缩进使用两个空格。

那是不是不能使用 `Tab` 进行缩进了？我们可以通过配置 `.editorconfig` ，将 `Tab` 自动转换为空格。

### 对象字面量的键值缩进

团队约定对象字面量的键和值之间不能存在空格，且要求对象字面量的冒号和值之间存在一个空格

*不推荐*

```js
const obj = { 'foo' : 'haha' }
```

*推荐*

```js
const obj = { 'foo': 'haha' }
```

### 构造函数首字母大写

在 JavaScript 中 `new` 操作符用来创建某个特定类型的对象的一个实例，该类型的对象是由一个构造函数表示的。由于构造函数只是常规函数，唯一区别是使用 `new` 来调用。所以我们团队约定构造函数的首字母要大小，以此来区分构造函数和普通函数。

*不推荐*

```js
const fooItem = new foo()
```

*推荐*

```js
const fooItem = new Foo()
```

### 构造函数的参数

在 JavaScript 中，通过 `new` 调用构造函数时，如果不带参数，可以省略后面的圆括号。但这样会造成与整体的代码风格不一致，所以团队约定使用圆括号

*不推荐*

```js
const person = new Person
```

*推荐*

```js
const person = new Person()
```

### 链式调用

链式调用如果放在同一行，往往会造成代码的可读性差，但有些时候，短的链式调用并不会影响美观。所以本规范约定一行最多只能有四个链式调用，超过就要求换行。

### 空行

空白行对于分离代码逻辑有帮助，但过多的空行会占据屏幕的空间，影响可读性。团队约定最大连续空行数为 2

*不推荐*

```js
const a = 1



const b = 2
```

*推荐*

```js
const a = 1


const b = 2
```

### 链式赋值

链式赋值容易造成代码的可读性差，所以团队约定禁止使用链式赋值

*不推荐*

```js
const a = b = c = 1
```

*推荐*

```js
const a = 1
const b = 1
const c = 1
```

### 变量声明

JavaScript 允许在一个声明中，声明多个变量。团队约定在声明变量时，一个声明只能有一个变量

*不推荐*

```js
const a, b, c
```

*推荐*

```js
const a
const b
const c
```

### 分号

JavaScript 在所有类 C 语言中是比较独特的，它不需要在每个语句的末尾有分号。在很多情况下，JavaScript 引擎可以确定一个分号应该在什么位置然后自动添加它。此特征被称为 自动分号插入 (ASI)，被认为是 JavaScript 中较为有争议的特征。

团队中对于是否应该使用分号，也有许多争论，本规范推荐不使用分号，因为我们认为好的工程师应该知道什么时候该加，什么时候不该加。

相关参考 ：[semi](http://eslint.org/docs/rules/semi)

### 代码块空格

一致性是任何风格指南的重要组成部分。虽然在哪里放置块的开括号纯属个人偏好，但在整个项目中应该保持一致。不一致的风格将会分散读者阅读代码的注意力。

> 团队约定代码块前要添加空格

*不推荐*

```js
if (a){
  b()
}

function a (){}
```

*推荐*

```js
if (a) {
  b()
}

function a () {}
```

### 函数声明的空格

当格式化一个函数，函数名或 function 关键字与左括号之间允许有空白。命名函数要求函数名和 function 关键字之间有空格，但是匿名函数要求不加空格。

> 团队约定函数括号前要加空格

*不推荐*

```js
function func(x) {
  // ...
}
```

*推荐*

```js
function func (x) {
  // ...
}
```

### 操作符的空格

团队约定操作符前后都需要添加空格

*不推荐*

```js
const sum = 1+2
```

*推荐*

```js
const sum = 1 + 2
```

### BOM

Unicode 字节顺序标记 (BOM) 用来指定代码单元是高字节序还是低字节序。也就是说，是高位在前还是低位在前。UTF-8 不需要 BOM 来表明字节顺序，因为单个字节并不影响字节顺序。

# 图片规范

## 图片命名

### 命名顺序

图片命名建议以以下顺序命名：

**图片业务（可选） +（mod_）图片功能类别（必选）+ 图片模块名称（可选） + 图片精度（可选）**

- 图片业务：
  - pp_：拍拍
  - wx_：微信
  - sq_：手Q
  - jd_：京东商城
  - …

- 图片功能类别：
  - mod_：是否公共，可选
  - icon：模块类固化的图标
  - logo：LOGO类
  - spr：单页面各种元素合并集合
  - btn：按钮
  - bg：可平铺或者大背景
  - …

- 图片模块名称：
  - goodslist：商品列表
  - goodsinfo：商品信息
  - userava tar：用户头像
  - …

- 图片精度：
  - 普清：@1x
  - Retina：@2x | @3x
  - …

如下面例子：

```
公共模块：
wx_mod_btn_goodlist@2x.png
wx_mod_btn_goodlist.png
mod_btn_goodlist.png 

非公共模块：
wx_btn_goodlist@2x.png
wx_btn_goodlist.png
btn_goodlist.png
```

## 交叉业务协作

业务交叉协作的时候，为了避免图片命名冲突，建议图片名加上业务和模块前辍，如拍拍侧和手Q侧的业务交叉合作时，侧栏导航icon雪碧图命名：

```
推荐：
pp_icon_mod_sidenav.png

不推荐：
icon_mod_sidenav.png
```

处理高清图片的时候，命名应该加上图片相应的精度说明

```
推荐：
jdc_logo@1x.png
jdc_logo@2x.png

不推荐：
jdc_logo.png
jdc_logo_retina.png
```

常见的图片格式有 GIF、PNG8、PNG24、JPEG、WEBP，根据图片格式的特性和场景需要选取适合的图片格式。

### GIF

> GIF图象是基于颜色列表的（存储的数据是该点的颜色对应于颜色列表的索引值），最多只支持8位（256色）。GIF文件内部分成许多存储块，用来存储多幅图象或者是决定图象表现行为的控制块，用以实现动画和交互式应用。GIF文件还通过LZW压缩算法压缩图象数据来减少图象尺寸

#### 特性

- 优秀的压缩算法使其在一定程度上保证图像质量的同时将体积变得很小。
- 可插入多帧，从而实现动画效果。
- 可设置透明色以产生对象浮现于背景之上的效果。
- 由于采用了8位压缩，最多只能处理256种颜色，故不宜应用于真彩色图片。

更多关于GIF：

[维基百科 - GIF](https://zh.wikipedia.org/wiki/GIF)

[GIF文档](http://dev.gameres.com/Program/Visual/Other/GIFDoc.htm)

### PNG

> PNG是20世纪90年代中期开始开发的图像文件存储格式，其目的是企图替代GIF和TIFF文件格式，同时增加一些GIF文件格式所不具备的特性。流式网络图形格式(Portable Network Graphic Format，PNG)名称来源于非官方的“PNG’s Not GIF”，是一种位图文件(bitmap file)存储格式，读成“ping”。PNG用来存储灰度图像时，灰度图像的深度可多到16位，存储彩色图像时，彩色图像的深度可多到48位，并且还可存储多到16位的α通道数据。PNG使用从LZ77派生的无损数据压缩算法。

#### 特性

- 支持256色调色板技术，文件体积小。
- 无损压缩
- 最高支持48位真彩色图像以及16位灰度图像。
- 支持Alpha通道的透明/半透明特性。
- 支持图像亮度的Gamma校准信息。
- 支持存储附加文本信息，以保留图像名称、作者、版权、创作时间、注释等信息。
- 渐近显示和流式读写，适合在网络传输中快速显示预览效果后再展示全貌。
- 使用CRC防止文件出错。
- 最新的PNG标准允许在一个文件内存储多幅图像。

更多关于PNG：

[PNG官方站 - PNG General Information](http://www.libpng.org/pub/png/)

[PNG格式](http://dev.gameres.com/Program/Visual/Other/PNGFormat.htm)

[维基百科 - PNG](https://zh.wikipedia.org/wiki/PNG)

### JPEG

> JPEG是一种针对照片视频而广泛使用的一种有损压缩标准方法。这个名称代表Joint Photographic Experts Group（联合图像专家小组）。此团队创立于公元1986年，1992年发布了JPEG的标准而在1994年获得了ISO 10918-1的认定

#### 特性

- 适用于储存24位元全采影像
- 采取的压缩方式通常为有损压缩
- 不支持透明或动画
- 压缩比越高影像耗损越大，失真越严重
- 压缩比在10左右肉眼无法辨出压缩图与原图的差别

更多关于JPEG：

[维基百科 - JPEG](https://zh.wikipedia.org/wiki/JPEG)

### WEBP

> WebP，是一种同时提供了有损压缩与无损压缩的图片文件格式，派生自视频编码格式 VP8，是由Google在购买On2 Technologies后发展出来。WebP最初在2010年发布，2011年11月8日，Google开始让WebP支持无损压缩和透明色的功能，而在2012年8月16日的参考实做libwebp 0.2.0中正式支持

#### 特性

- 同时提供有损压缩和无损压缩两种图片文件格式
- 文件体积小，无损压缩后，比 PNG 文件少了 45％ 的文件大小；有损压缩后，比 JPEG 文件少了 25% - 34% 文件大小
- 浏览器兼容差，目前只支持客户端 Chrome 和 Opera 浏览器以及安卓原生浏览器(Andriod 4.0+)，[WebP兼容性](https://developers.google.com/speed/webp/faq#which_web_browsers_natively_support_webp)

更多关于WebP：

[维基百科 - WEBP](https://zh.wikipedia.org/wiki/WebP)

[WEBP探寻之路](http://isux.tencent.com/introduction-of-webp.html)

### 内容图

内容图多以商品图等照片类图片形式存在，颜色较为丰富，文件体积较大

- 优先考虑 JPEG 格式，条件允许的话优先考虑 WebP 格式
- 尽量不使用PNG格式，PNG8 色位太低，PNG24 压缩率低，文件体积大

### 背景图

背景图多为图标等颜色比较简单、文件体积不大、起修饰作用的图片

- PNG 与 GIF 格式，优先考虑使用 PNG 格式,PNG格式允许更多的颜色并提供更好的压缩率
- 图像颜色比较简单的，如纯色块线条图标，优先考虑使用 PNG8 格式，避免不使用 JPEG 格式
- 图像颜色丰富而且图片文件不太大的（40KB 以下）或有半透明效果的优先考虑 PNG24 格式
- 图像颜色丰富而且文件比较大的（40KB - 200KB）优先考虑 JPEG 格式
- 条件允许的，优先考虑 WebP 代替 PNG 和 JPEG 格式



**PC平台单张的图片的大小不应大于 200KB。**

**移动平台单张的图片的大小不应大于 100KB。**

- 上线的图片都应该经过压缩处理，压缩后的图片不应该出现肉眼可感知的失真区域
- 60质量的JPEG格式图片与质量大于60的相比，肉眼已看不出明显的区别，因此保存 JPEG 图的时候，质量一般控制在60，若保真度要求高的图片可适量提高到 80，图片大小控制在 200KB 以内

## 图片优化

### 图片标签

HTML 中图片引入不需添加 width、height 属性，alt 属性应该写上

*推荐：*

```html
<img src="" alt="" >
```

*不推荐：*

```html
<img src="" width="" height="" >
```

CSS 中图片引入不需要引号

```css
.jdc {
    background-image: url(icon.png);
}
```

2. JPG图片必须压缩，一般80%品质即可，保证文字清晰
3. JPG图片必须使用渐进式图片：使用Photoshop的“存储为web所用格式”时候，勾选“连续”
4. 透明PNG图片必须使用[压缩工具](https://tgideas.qq.com/doc/frontend/tool/imagecompress.html)压缩后提供

### 合理切图

1. 需要变动的文字禁止切到图片中，如果不确定是否需要变动，请咨询接口人
2. 需要程序后台动态生成的图片，如道具图片、头像、奖品，必须单独切割出来
3. 装饰性图片合并成精灵图(CSS Sprites)，减少页面请求

### CSS Sprites VS Data URIs

#### CSS Sprites特点

- 减少请求数
- 加速图片的显示
- 维护更新成本大
- 更多的内存消耗，特别是大体积或有过多空白的 Sprites 图
- 图片渗漏，相邻的不需展示的图片有可能出现在展示元素中，特别是在高清设备移动设备上

#### Data URIs（base64编码）

- 减少请求数
- 转换文件体积大，大约比原始的二进制大33%
- IE6 / IE7 不支持
- 图片显示相对较慢，需要更多的CPU消耗

### CSS Sprites 使用建议

- 适合使用频率高更新频率低的小图标
- 尽量不留太多的空白
- 体积较大的图片不合并
- 确保要合并的小图坐标数值和合并后的 Sprites 图尺寸均为偶数

### Data URIs（base64编码）使用建议

- 适合更新频率高的小图片，如某些具备自定义功能的标题icon等
- 转换成 Base64 编码的图片应小于 2KB
- 移动端不使用 Base64 编码
- 要兼容 IE6/IE7 的不使用

### 图片地址分离

专题完成，需进行图片地址分离

把图片放到`ossweb-img`文件夹里面，图片引用的时候src为`game.gtimg.cn`域名下的特定地址。
分离后示例：

```css
/*分离前*/
.bg{background: url(ossweb-img/hd.jpg) no-repeat;}
/*分离后*/
.bg{background: url(//game.gtimg.cn/images/xiangqi/cp/a20150730avatar/hd.jpg) no-repeat;}
```

图片必须分离；css文件、js文件可视情况，不是必须分离。

为了本地正常预览，**分离前**文件请使用相对路径或补全`http://`

### 如何知道分离路径

1. 百度搜索官方域名，找到官网地址，确保一级域名
2. 查看官网首页源码样式表中的图片的地址，确认其中含有上一步得到的项目名；否则请找接口人确认
3. 图片分离地址示例：`//game.gtimg.cn/images/peng/cp/a20090817booking/`，其中`peng`就是项目名的简写
4. 分离地址只有**项目名**和**专题名**需要修改
5. 图片跨域问题的解决：设置图片`crossOrigin`属性为`Anonymous`，同时把图片域名`game.gtimg.cn`换为`ossweb-img.qq.com`

## 注释与命名

### 注释

页面头部需要添加制作时间等信息。

在head区域中，title标签下方的注释，按照下方格式分别加上页面设计、页面制作的公司名称，创建的年-月-日

```html
<head>    
    <title>页面名称-产品中文全称-官方网站-腾讯游戏-产品slogan</title>
     <!-- 页面设计：公司名称 | 页面制作：公司名称 | 创建：2017-09-09  -->
</head>
```

页面设计、页面制作填写具体公司名称，创建：填写页面创建的时间。

禁止注释中出现制作者的个人信息，如姓名、QQ号、邮箱等。

如果是需要和后台开发联调的自定义函数。请注明函数的调用方式，包括函数的用途、参数类型等。

```js
// 转盘初始化
// 参数1：是奖品的个数，数字类型
// 参数2：用来旋转的圆盘元素，可为dom元素 或 选择器字符串
var panel=new PanelLotery({
    length:8,
    el:'#ltpanel'
});
```

### 命名

样式命名

1. class、id都需小写
2. 命名使用英文，禁止使用特殊字符
3. 样式名不能包含`ad`、`guanggao`、`ads`、`gg`是广告含义的关键词，避免元素被网页拓展、插件屏蔽
4. 名称间隔使用`-`符号
5. 涉及数据、交互等需要联调的部分，禁止通过id选择器定义样式，以免开发过程中id名变化，引起页局错乱
6. 类名命名需要语义化，参考下面的示例：

```css
 .wrap{}                 //外层容器
 .mod-box{}              //模块容器
 .btn-start{}            //开始
 .btn-head-nav1{}        //头部导航链接1
 .btn-news-more{}        //更多新闻
 .btn-play{}             //播放视频
 .btn-ico{}              //按钮ico
 .side-nav{}             //侧栏导航
 .side-nav-btn1{}        //侧栏导航-链接1 
 .btn-more{}             //更多
```

图片命名

1. 图片名称必须小写，禁止使用特殊字符、中文

2. 使用英文或拼音缩写，禁止特殊字符

3. 名称间隔使用`-`符号

4. 命名需要能体现图片的大概用途

   常用示例：

   ```
   bg.jpg          //背景图片
    mod-bg.jpg      //模块背景
    sprites.png     //精灵图
    btn-start.png   //开始按钮
    ico-play.png    //修饰性图片
   ```

5. 禁止文件名和实际图片内容不符。反面例子：图片名为'weixin-qrcode'，图片内容却是头像。

## 文件目录

- 图片文件夹：`ossweb-img`
- CSS文件夹：`css`
- JS文件夹：`js`
- include页面片段文件夹：`inc`

路径[分离前](https://tgideas.qq.com/doc/frontend/spec/common/image.html)文件图片、CSS、JS引用的资源路径保留`http:`或者使用相对路径，不然本地无法预览。 路径 分离后 的CSS、JS引用的资源路径使用相对域名根目录的路径`/cp/专题目录/`。

### include

- 多页面专题，提取页面相同HTML代码片段，页面中include载入使用

- 路径需要从域名根目录开始，引用方式必须为`virtual`，**不能**为`file`

- include推荐使用.html格式，可以在文件中再次include其他文件

  正确:

```html
<!--#include virtual="/web201801/inc/nav.html" -->
<!--#include virtual="/m/m2018/inc/nav.html" -->
<!--#include virtual="/cp/a20160112music/inc/nav.html" -->
```

​		错误:

```html
<!--#include file="/inc/文件名.html"-->
<!--#include file="inc/文件名.html"-->
```

### 专题目录命名

专题目录就是重构包文件夹名称，使用 a+日期+专题英文或拼音 统一使用小写字母，例如：`a20090817avatar`，文件名禁止以数字开头。 重构包命名优先使用有意义的英文名，如使用拼音，拼音字符超过10个，请使用首个拼音的全称+后面拼音的简写

### 文件命名

所有文件名统一使用小写，首页命名为`index.html` html内页，有明显分类的，参考使用以下示例命名，无明确意义的，可用page01.html、page02.html，禁止使用特殊字符，统一使用小写字母


# 数据统计

## 数据统计

页面需要使用**PTT统计代码组件**`ping_tcss_tgideas_https_min.js`进行数据上报。

如没有正确执行上报，少加、漏加、错加代码将导致页面统计不到任何数据，后果很严重。

### 页面PV统计代码

需要在页面底部添加PTT统计代码，如果是官网记得`siteType`属性填写为`os`

### 重要提醒

PTT 的主函数 `pgvMain()` 请不要延迟执行，建议直接调用(立即执行函数)，或者最迟在 `document.DOMContentLoaded`(即通常理解的`domReady`) 事件内调用。晚于此时间点上报统计请求，有**统计数据丢失**的风险，也会触发**网页质量工单**。

```js
<script src="//ossweb-img.qq.com/images/js/PTT/ping_tcss_tgideas_https_min.js"></script>
<script>
//此段代码不能放到外链JS中，
var setSite={ //设置网站属性 
    siteType:"a20160711xxx", //必填项:"os"代表是官网，如果不是，则填写actName例如a20160701xxx
    pageType:"index", //必填项:本页面的定位；按照页面含义填写例如main||list||detail||download||share||page1||pageN,不支持点(.)、下划线(_)
    pageName:"首页", //必填项:页面中文名 
    project:"other", //选填项:如果是官网模块则是必填;按照模块内容，填写固定的对应值;官网微社区base;同人站doujin;赛事match;故事站story;文化站history;粉丝站fans;爆料站coming;论坛bbs;皮肤skin;默认other;
    osact:0 //选填项:默认是0。osact=0表示非官网专题；osact=pc表示pc官网/pc官网专题；osact=m表示移动官网/移动官网专题；osact=ingame表示微社区/微社区专题
};
if(typeof(pgvMain)=='function')pgvMain();//千万不能忘记！
</script>
```

**注意**

`siteType`要么填写`os`要么填写文件夹名称，不要直接复制照搬，必须全小写。
PTT所有埋点如有多个单词拼接，请使用英文中横线(-)，禁止所有其他写法例如点(.)、下划线(_)、英文逗号(,)、驼峰式(大小写)等，包括但不限于siteType、pageType、pageName、PTTSendClick、exposure。

一般只需要改的是前三项siteType、pageType、pageName，其中pageType和pageName可以自定义，可参考上面代码中的注释。

**不要遗漏**

不要忘了在加载完PTT组件后，执行`if(typeof(pgvMain)=='function')pgvMain();`

如果使用PTT上报方式，以下组件由于PTT上报已经集成故不能使用，会冲突：

```js
js/comm/stayTime.min.js 停留时间统计组件

js/comm/pagecount.min.js 停留时间统计组件

js/comm/exposure.min.js 触达率/曝光次数统计组件
```

**关于setSite.project**

选填，目的是区分官网类型，在官网体系内是必填项。

**曝光埋点**

用来统计官网的模块的曝光量和模块点击

官网一定要添加

**使用方法**

PC端和移动端用法一样； 在官网模块dom结构上添加`exposure-tag="英文名,中文解释"` 属性及值；

```html
<div class="news" exposure-tag="英文名,中文解释"></div>
<!-- 例如： -->
<div class="news" exposure-tag="news,新闻"></div>
```

### 按钮上报

### PC端

```html
<!-- 分享给朋友 -->
<a href="#" onclick="PTTSendClick('btn','share','分享');">分享给朋友</a>
<!-- 视频播放 -->
<a href="#" onclick="PTTSendClick('btn','playvideo','播放视频');">播放视频</a>
```

### 移动端

```js
<a href="javascript:;" id="btnStart">开始游戏</a>
<script src="//osswebimg.qq.com/images/js/mobile_build/util/zepto.js"</script>
<script>
    $("#btnShare").tap(function(){
        PTTSendClick('btn','share','分享');
      });
 </script>
```

直接在dom元素上增加onclick事件，在传递参数的时候，请确保双引号和单引号的嵌套使用正确。 页面中，PTTSendClick传递的第二个参数不能重复，必须是唯一值

如页面为翻屏形式，在每次翻屏结束时的回调函数中执行上报，其中e.nowpage为当前页,e.nextpage为翻屏触达的页

```js
PTTSendClick('page','page' + e.nowpage + 'to' + 'page' + e.nextpage,'翻屏');
```

H5专题中，如需要统计页面加载流失等，可以将PTT组件前置放在head中，JS脚本执行

```js
PTTSendClick('page','loadstart','开始加载');
```

在页面加载完成的回调函数中执行

```js
PTTSendClick('page','loadend','加载结束');
```

如在脚本中使用到PTTSendClick，比方说统计流失率。

在页面的进入执行`PTTSendClick('loading','loadstart','开始加载');`

以及加载完成执行`PTTSendClick('loading','loadend','加载完成')`进行数据上报时候，需要确保在此之前PTT组件已经加载完成且已经执行过`pgvMain`这个函数，不然执行`PTTSendClick`会报错。

### ADTAG上报

数据上报还有另外一种方式是在链接上加一个参数，用于特定渠道访问量统计。比如链接是`http://pvp.qq.com`，那在后面拼接参数`ADTAG=专题名称.位置.描述`

注：用英文句号`.`做分割，最多不可超过4个

最终为：`http://pvp.qq.com?ADTAG=a20170505.btn.logo`

如果原链接本来就带参数，比如`http://pvp.qq.com/path/page.html?id=123`,加上`&`再拼接即可，和平常的url传参方式一样。

最终为：`http://pvp.qq.com/path/page.html?id=123&ADTAG=a20170505.btn.logo`

### 虚拟上报

虚拟上报分为虚拟域名和虚拟页面

- 虚拟页面

  如果一个页面需要区分多种情况，可以构造不同的虚拟URL，这样就可以使用虚拟后的URL查看此页面的数据，

  其中virtualURL：虚拟URL，注意不要包含域名，要以"/"开头。

```js
  if(typeof(pgvMain) == 'function') pgvMain({virtualURL: "/path/xxx.html"});
```



- 虚拟域名

  适用情形：如果一个页面需要上报数据到另外的域名，可以构造虚拟域名，构造虚拟域名后需在虚拟域名下查看该页面的数据

  virtualDomain：虚拟域名，会发送这个域名到点击流服务器

```js
  if(typeof(pgvMain) == 'function') pgvMain({virtualDomain: "xxx.qq.com"});
```

### 内嵌页面上报（iframe）

如果页面有iframe，且页面和iframe都使用了PTT上报，默认情况下，iframe上报的是父页面的pv，而不是iframe自己url的pv。

如果需要iframe上报自己url的pv，则需要在iframe页面（不是父页面）数据上报初始化时添加配置**statIframe: true**。

```js
if(typeof(pgvMain) == 'function') pgvMain({statIframe: true});
```

父页面和iframe页面不同域名的话，则没有影响。

### 单页面重复上报，无刷新切换

单页面多次上报，适用于单页面的异步请求或者单页面需要多次上报等业务场景；例如微社区的交互，页签的切换不会让整个页面重新加载，而是只请求内容然后插入或者 替换到对应区域。

添加参数说明：**repeatApplay："true"**

```js
<script>
setSite={...pageType:"page1"...}
if(typeof(pgvMain) == 'function')pgvMain({repeatApplay: "true"});//加载页面首次执行
function route(N){    
setSite={...pageType:"page"+N...};      //设置新的setSite属性    
pgvMain({repeatApplay: "true", virtualURL : path[N] });   //用新的setSite属性进行再次上报    
...      //路由代码
}
</script>
```

### 其他上报方式

除非项目指定使用以下`ping_tcss_ied`上报数据，否则统一使用上面的 **PTT统计代码组件**

页面PV统计

```js
<!-- 底部加入JS -->
<script src="//pingjs.qq.com/ping_tcss_ied.js"></script>  
<script>if (typeof (pgvMain) == 'function') { pgvMain(); }</script>
```

按钮上报

```js
<!-- 按钮上报，参数为：专题名称.页面名称.元素描述.功能 -->
<a href="javascript:;" onclick="pgvSendClick({hottag:'a20150825file.index.btn.open'});"></a>
```

使用`ping_tcss_ied`上报时候，虚拟上报和ADTAG使用同PTT统计代码组件。

**点击流的上报JS有多个版本，不同项目可能会有不同的要求。 页面中记得不要重复引用多个上报JS，比如引用了ping_tcss_ied.js又引用了ping_tcss_tgideas_https_min.js。**

## 埋点

###  官网埋点规范

### 一、内容详情页添加上报参数

详情页需要增加 **文章id（targetId）**、**文章类型（targetType）**、**文章出处（from）**的上报，在setSite里增加配置。

```js
<script src="//ossweb-img.qq.com/images/js/PTT/ping_tcss_tgideas_https_min.js"></script>
<script>
//此段代码不能放到外链JS中，
var setSite={ //设置网站属性 
    siteType:"os", //必填项:"os"代表是官网，如果不是，则填写actName例如a20160701xxx
    pageType:"newsdetail", //必填项:本页面的定位；按照页面含义填写例如main||list||detail||download||share||page1||pageN,不支持点(.)、下划线(_)
    pageName:"新闻详情", //必填项:页面中文名 
    project:"base", //选填项:如果是官网模块则是必填;按照模块内容，填写固定的对应值;官网微社区base;同人站doujin;赛事match;故事站story;文化站history;粉丝站fans;爆料站coming;论坛bbs;皮肤skin;默认other;
    osact:'pc' //选填项:默认是0。osact=0表示非官网专题；osact=pc表示pc官网/pc官网专题；osact=m表示移动官网/移动官网专题；osact=ingame表示微社区/微社区专题
    targetId:"12345",//文章id
    targetType:"news",//文章类型：'news' || 'video' || 'moment' || 'other'
    from:"v4"//文章出处：'v4'||'ams'||'tgl'||'ingame'||'other'
};
if(typeof(pgvMain)=='function')pgvMain();//千万不能忘记！
//动态请求内容的详情页，需要把以上放入到请求回调中执行，因为targetId只有在请求成功后才有值，才能完整上报
</script>
```

参数说明

##### 1、targetType推荐三种取值，特殊情况由官网产品指定：

① news //图文资讯

② video //视频

③ moment //UGC（用户原创内容）

④ other //如果不符合以上值，或者填错

##### 2、from取值根据接入的资讯系统名称，分为：

① tgl

② v4

③ ams

④ ingame //微社区UGC体系

⑤ other //如果不符合以上值，或者填错

##### 3、正确获取targetid字段的方法和说明文档：

######  ① V4静态模版下如何获取targetid

在静态模版html里，设置targetId等于{$detail.id}，如：

Copy

```javascript
setSite = {
  ...
   targetId:'{$detail.id}',
  ...
}
```

###### ② AMS静态模版下如何获取targetid

在静态模版html里，设置targetId等于'$iInfoId.DATA$'，如：

Copy

```javascript
setSite = {
  ...
  targetId:'$iInfoId.DATA$',
  ...
}
```

###### ③ V4动态拉取下如何获取targetid

在动态请求到详情页数据后，把返回的iNewsId（图文类型）或者iVideoId（视频类型）赋值给targetId，如： https://apps.game.qq.com/wmp/v3.1/public/searchNews.php?p0=128&source=ingame&p1=1&id=8022836 里的iNewsId 然后再执行pgvMain()

###### ④ TGL动态拉取下如何获取targetid

在动态请求到详情页数据后，把返回的inforid赋值给targetId，如： https://itea-cdn.qq.com/file/tglStatic/details/372/3/art1257163.js?callback=json1257163callback&_=1570708593155 里的inforid 然后再执行pgvMain()

### 验证

在请求里，查找click，然后看action:pv的请求，targetid,targettype,from的值是否正确。

### 二、内容列表页添加曝光和点击

官网列表页、首页列表增加每条列表的曝光和点击，用 `PTTSendReport({'action': 'pop'})` 来上报曝光， `PTTSendReport({'action': 'click'})` 来上报点击。

>  **提示** [GICP新闻填充组件](https://ossweb-img.qq.com/images/js/fillnewsgicp/) v1.4或以上版本已经集成了内容详情参数上报、列表曝光点击上报，推荐使用。如果是视频列表，并且视频是在当前列表页点击播放（即不跳视频详情页），需要将`pgvMain()`加上参数，变成`pgvMain({repeatApplay: "true"});` 。详情查看[Demo](https://ossweb-img.qq.com/images/js/fillnewsgicp/doc/v1.4/demo-dmp-list.html)

#### 上报方法

```javascript
PTTSendReport({
    action: 'click', //行为区分，'pop'||'click'
    targetid: '12345',//文章id
    targettype: 'news',//文章类型：'news' || 'video' || 'moment' || 'other'
    from: 'v4'//文章出处：'v4'||'ams'||'tgl'||'ingame'||'other'
})
```

| action     | 行为区分，pop-曝光上报、click-点击上报                       |
| :--------- | ------------------------------------------------------------ |
| targetid   | 文章id，例：40963（不同系统获取id的接口有区别，具体方法见上面：内容详情页添加上报参数—参数说明—3） |
| targettype | 文章类型，分为：news-图文、video-视频、moment-动态、other-其他 |
| from       | 文章出处，分为v4、ams、tgl、ingame-微社区UGC体系、other      |

#### 点击上报

每条列表被点击时，上报一个 **action:'click'**

```html
<ul>
    <li onclick="PTTSendReport({'action': 'click','targetid': '672562','targettype':'news', 'from': 'v4'})">国服最强李白秀翻全场</li>
</ul>
```

```javascript
li.addEventListener('click', function(){
    PTTSendReport({
        action: 'click',
        targetid: '672562',
        targettype: "news",
        from: 'v4'
    })
}, false)
```

#### 曝光上报

每条列表出现在可视范围时，上报一个 **action: 'pop'**，可以批量上报多个id。

```javascript
PTTSendReport({
    action: 'pop',
    targetid: '672562,672563',//支持批量上报，targetid用英文逗号分隔
    targettype: "news",
    from: 'v4'
})
```

### 三、重点按钮类型规定

| 重点按钮 | 埋点规范                                            |
| -------- | --------------------------------------------------- |
| 下载     | PTTSendClick(**download**','iosdownload','ios下载') |
| 投稿     | PTTSendClick('**submit**',' submit','投稿')         |
| 评论     | PTTSendClick('**comment**','comment','评论')        |
| 点赞     | PTTSendClick('**like**','like','点赞')              |

除了以上几类重点按钮，其他按钮、链接还是推荐第一位书写**btn**、**link**

# 双端

## PC端

- 为防止加载title.js后页面跳动，为头部设置42px的内边距；

**组件CDN**

```html
<script src="//ossweb-img.qq.com/images/js/title.js"></script>
```

**示例**

```js
<head>
<style>
/* title样式，为头部设置42px内边距，防止加载title后页面跳动 */
body{padding-top: 42px;}
</style>
</head>
<body>


<!-- titleJS代码 S-->
<script src="//game.gtimg.cn/images/js/title.js"></script>
<!-- titleJS代码 E-->
</body>
```



### 页面兼容

浏览器兼容性测试

1. 兼容IE8及以上、Firefox、chrome、QQ浏览器
2. 页面如无指定，不需要兼容IE6、7
3. 不兼容IE6、7的情况下，需要在页面顶部加入提示，并对`.browser-tips`使用醒目的颜色标识样式

分辨率兼容

1366x768~1920x1080，拖大和缩小窗口，页面布局不会发生错位。

## 移动端

### 页面尺寸

移动端设备屏幕尺寸非常多，为了适配不同设备，推荐使用iPhoneX的屏幕比例作为基准，使用尺寸大小：750x1624px，同时需保证重要内容在安全区域内，尺寸大小：646x1206px。

例外情况

如果专题有跳转逻辑，比如登录引起的跳转，会引起微信浏览器底部出现导航条。此时的安全区域尺寸大小：646x1112px

部分设备分辨率可查询[SCREEN SIZES](http://screensiz.es/)，并参考[设备的分辨率分布](https://mta.qq.com/mta/data/device/resolution)

###  移动端设计稿推荐设计尺寸：750x1624px，重要内容在安全区域内：646x1206px

移动端的首屏尤为重要，很多时候用户只关注到首屏的内容。并且很多移动端页面采用分屏浏览的的形式，这种形式让用户更集中注意力在一个画面中。首屏范围的设定选取的主流机型IPHONE6的分辨率大小，安全宽高为向下兼容到iphone5s的尺寸。

考虑到目标用户为游戏玩家，对设备要求较高，故而舍弃过去兼容到4s的尺寸，也更加便于设计师的发挥。

重要的操作按钮，主体slogan和游戏icon的露出，需要再安全区域内展示。

### 首屏范围的由来

市面上的机型超过65%的长宽比为178:100，如果按照设计app的思路，只需要选取一个中间设备iPhone 6尺寸来适配即可，但我们发现微信/手Q的浏览器头部并不是按照等比来缩放的，所以如果设计稿按照iPhone 6尺寸来等比例放大到iPhone 6 plus上，会出现留有一条黑边。

所以我们使用iPhone 6的大小等比例缩小到iPhone 6的尺寸，让设计稿溢出一点，当再适配到其他设备时，减去溢出的部分即可也不会影响设计稿的质量。

iphone5/6的头部为128高度; 而iphone6 plus的高度为192导致浏览框的比例不完全统一

### 适配剩下35%尺寸

让设计稿在178:100的比例中显示最佳状态，在其他尺寸尽量信息完整

### 页面排版

### 标题文字

- 主标题建议在7个字内，一行最多不超过7字，标题一般是经过设计的字体
- 副标题文字需要能够说明详细活动信息，字体建议在24-40号之间

标题文字超过7个字的情况下，文字折行处理，并且加强重要词语

### 正文标题与内容

标题：字号48，使用粗体

正文：字号30点，使用常规体

引文和次要信息：字号24

段首无需空格，左对齐即可

###  文章列表的字号与间距

文章的标题不宜过长，建议控制在18字内

文章列表的间距需不得小于90px

字号建议用26~30号

### 页面组件

### 按钮

- 页面只有一个按钮时候，按钮居中对齐，按钮高度需要大于80px
- 如果按钮的重要级相当，建议用左右布局；不一致则建议用上下布局

###  页签与导航

- 移动端页面页签最多5个，页签字数一般2个，支持左右滑动切换页签
- 页签整体宽度与对应的内容宽度对齐，高度大于90px；字体大于30号，使用粗体
- 头部条的高度建议120px，icon的大小为100x100px
- 首页导航条：标签最多不超过三个

### 图标

- 热区大小 最小面积：44x44像素
- 图形大小 最小面积：30x30像素

# 页面兼容

### 移动端页面兼容要求

###  浏览器兼容

### 系统平台兼容

兼容安卓4.4及以上、iOS最新版本，页面能正常预览，无错位。

### 页面功能

检查视频、音频是否正常播放；涉及自动播放的视频H5，推荐使用[移动端视频组件](https://tgideas.qq.com/doc/frontend/component/m/mmd.html)

## rem布局

### viewport

```css
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
```

### 初始字号

css中设定html根元素的初始字体大小为100px

```css
html{font-size:100px;}
```

### 单位转换

不管你拿到的设计稿宽度是640px还是750px，多大都一样。和我们平时做PC页面的做法基本一样，只需要把单位px换算成rem，所有设计稿的的元素大小全除以100单位换成rem，例如设计稿上个某个文字的大小为30px，直接写font-size:0.3rem。

1rem = 100px

### 注意事项

使用rem方式布局有以下几点需要注意：

- 页面用不同尺寸的手机进行测试
- 因为小于1px浏览器支持不够好为会导致计算会有误差，背景图使用雪碧图时，图标之间多留5px的空隙，同时图片的backgrornd-size属性最好写上图片的宽高，不写误差更大。　
- 雪碧图，如图片宽高为346px*160px需要设置background-size属性设置为background-size: 3.46rem 1.6rem;
- 大小为1px的元素不要使用rem，直接用px
- 多栏多列布局优先使用百分比`%`或是`display:flex`

## 移动端H5页面音频/视频规范

移动端设备屏幕尺寸、分辨率各不相同，不同系统对音频/视频的支持情况也不一样，为了音频/视频可以在不同设备表现更好，请参阅以下规范。

###  视频H5页面交互设计建议

- 因视频文件一般较大，为了体验流畅，需要设计加载页面，页面尺寸同视频分辨率一致；
- 对于不能自动播放视频的设备，设计开始播放视频的指引按钮；

## 移动端页面字体使用参考

PC页面中通常使用微软雅黑作为中文字体进行设计，但在移动端，手机系统 ios、android 等是不支持微软雅黑字体，建议使用移动端系统默认的字体进行设置；如需求中有特殊字体或者图标可以使用WEB字体进行设置；

###  系统默认字体设置

```css
body {
    font-family: -apple-system, BlinkMacSystemFont, "PingFang SC","Helvetica Neue",STHeiti,"Microsoft Yahei",Tahoma,Simsun,sans-serif;
}
```

 **说明**

`-apple-system` 是在以 WebKit 为内核的浏览器（如 Safari）中，调用 Apple（苹果公司）系统（iOS, macOS, watchOS, tvOS）中默认字体（现在一般情况下，英文是 San Francisco，中文是苹方）
`BlinkMacSystemFont` 是在 Chrome 中实现调用 Apple 的系统字体

**ios 系统默认字体**
iOS 4.0+： 中文字体为 "华文黑体STHeiTi"、英文字体为 "Helvetica Neue"；

iOS 9+： Safari开始支持 -apple-system 参数， Chrome 使用 BlinkMacSystemFont ，兼容 iOS ／ MacOS

**android 系统默认字体**
原生Android下中文字体与英文字体都选择默认的无衬线字体。

4.0 之前版本英文字体原生 Android 使用的是 Droid Sans，中文字体原生 Android 会命中 Droid Sans Fallback

4.0 之后中英文字体都会使用原生 Android 新的 Roboto 字体

**winphone 系统默认字体** 默认中文字体是Dengxian(方正等线体)
默认英文和数字字体是Segoe

综上，各个手机系统有自己的默认字体，如无特殊需求，手机端无需定义中文字体，建议使用系统默认字体。如果需求包含特殊字体，可以使用CSS3 `@font-face`进行定义。

### WEB字体

移动端IOS系统、安卓系统均支持`.ttf`格式的字体，WEB字体选择中建议引用`.ttf`格式字体；

```css
// 定义web字体
@font-face {
    font-family: 'WebFontName';
    src: url('WebFontName.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
   }

.WebFontName {
     font-family: 'WebFontName'
   }
```

在使用web字体前，请先确认字体是否免费，或是否有该字体的版权；
中文字体文件一般较大，有几M或者更大，建议使用工具提取页面中需要的字的字体文件；

# 特殊规范

## 页面跳转

双端页面，自动判断跳转

```js
(function() {
if(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)){var a=document.referrer,b={"baidu.com":"seo_baidu","sogou.com":"seo_sogou","sm.cn":"seo_sm","so.com":"seo_360","bing.com":"seo_bing","google.com":"seo_google"},c;for(c in b){if(-1!=a.indexOf(c)){a=b[c];if(window.sessionStorage){sessionStorage.setItem("channel",a)}else{var d=d||0,b="";0!=d&&(b=new Date,b.setTime(b.getTime()+1000*d),b="; expires="+b.toGMTString());document.cookie="channel="+escape(a)+b+"; path=/"}break}}window.location.href="/m/"+location.search};
})();


```



## 双端官网规范

部分游戏产品官网需要同时兼容PC浏览器、移动端浏览器的访问，称为双端官网。一般情况下采用两套不同的页面。

## PC官网

PC官网用web+年月来命名，如【web201805】

### 页面跳转

PC官网首页在头部添加移动端访问自动跳转到移动端官网JS代码

```html
<script>
    (function () { var a = navigator.userAgent; if (-1 != a.indexOf("iPhone") || -1 != a.indexOf("iPad") || -1 != a.indexOf("iPod") || -1 != a.indexOf("Android")) { var a = document.referrer, b = { "baidu.com": "seo_baidu", "sogou.com": "seo_sogou", "sm.cn": "seo_sm", "so.com": "seo_360", "bing.com": "seo_bing", "google.com": "seo_google" }, c; for (c in b) if (-1 != a.indexOf(c)) { a = b[c]; if (window.sessionStorage) sessionStorage.setItem("channel", a); else { var d = d || 0, b = ""; 0 != d && (b = new Date, b.setTime(b.getTime() + 1E3 * d), b = "; expires=" + b.toGMTString()); document.cookie = "channel=" + escape(a) + b + "; path=/" } break } self.location = "/m/" } })();
</script>
```

### 移动端官网

移动端官网用m+年月来命名，如【m201805】

## 双端官网

### 新闻列表

- 新闻列表HTML结构需要整齐，不能使用多种复杂结构
- 列表尽量不要对某一个li元素设置css类名
- 段落文字过长CSS处理成省略号，新闻详情页面使用_blank新开窗口

### 新闻详情

- 内容尽量模拟真实场景，确认内容完整性、兼容性，需要设置页面min-height，并且背景repeat做成可拓展。
- CSS中对详情页单独设置`img,iframe,video,table{max-width:100%;height:auto}`

### 视频列表

- 如包含视频列表页面，点击视频时需要能正确切换播放
- 关闭弹窗时视频停止播放（请带上耳机检查），同时检查删除测试数据。

### 公共文件

1. 公共元素必须提取成html，页面include载入(提取的公共元素按照模块划分，不可将一个模块拆成多个)。
2. 公共CSS必须提取成comm.css
3. 公共js必须提取成main.js

### footer

1. PC官网footer必须在页面上声明ID为gfooter的div
2. 引用公用的footer.js，根据footer.js组件说明，检查、确认版权号等相关敏感信息是否正确。

### 页面分离

移动端官网分离路径多一层m的目录

## 页面内容检查

### 文字

- 检查页面文字是否有错别字
- 检查文字中有无任何政治敏感信息
- 页面中如有使用到英文，需要确保英文准确，切忌胡乱翻译。

### 图片

- 需要排除图片版权问题，常见如人物形象、道具、抽奖图片、KV、Logo等
- 图片内容需要和文字描述保持一致
- 图片中使用到的特殊字体，需要确保得到字体授权，禁止使用任何没有得到授权的字体。
- 如图片对于身体暴露程度较高，需要和产品协商确认

### 视频

- 视频中如使用非游戏内的素材，需要确保得到授权。对于内容，需要验证没有错别字、政治敏感、身体暴露等违规内容
- 腾讯视频广告如需要屏蔽，参照【腾讯视频广告屏蔽指引】进行操作
- 使用非腾讯视频的视频源时，需要单独上传到指定服务器，页面引入JS进行调用，【[详情点击](https://tgideas.qq.com/doc/frontend/component/common/txplayer.html#其他)】

### 音频

- 音频使用.mp3格式，页面使用audio播放。
- 音频进行压缩，文件大小控制在5M以内；

## 安全指引

- **不要在页面中插入任何不可信数据，除非这些数据已经据根据编码规则进行了编码**
- **页面中不要引用外部CDN资源的JavaScript文件、CSS文件**
- **对用户输入的内容进行安全性验证**

### 常见的前端安全问题

前端的安全问题主要集中在跨站脚本攻击(XSS)这一类，产生XSS漏洞的原因各种各样，对于漏洞的利用也是花样百出，我们先来认识下它。
跨站脚本攻击（Cross Site Scripting）为不和 CSS混淆，故将跨站脚本攻击缩写为XSS。
恶意攻击者往Web页面里插入恶意Script代码，当用户浏览该页之时，嵌入其中Web里面的Script代码会被执行，从而达到恶意攻击用户的目的。
**防范XSS：**

- 对输入进行验证
- 对输出进行编码

想详细了解可以参考这两篇文章 《[Cross-site Scripting (XSS)](https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)#Stored_and_Reflected_XSS_Attacks)》 和 《[DOM Based XSS](https://www.owasp.org/index.php/DOM_Based_XSS)》

### URL跳转漏洞

借助未验证的URL跳转，将应用程序引导到不安全的第三方区域，从而导致的安全问题。
由于是从可信的站点跳转出去的，用户会比较信任，所以跳转漏洞一般用于钓鱼攻击，通过转到恶意网站欺骗用户输入用户名和密码盗取用户信息，或欺骗用户进行金钱交易；
也可能引发的XSS漏洞（主要是跳转常常使用302跳转，即设置HTTP响应头，Locatioin: url，如果url包含了CRLF，则可能隔断了http响应头，使得后面部分落到了http body，从而导致xss漏洞）。
如https://qt.qq.com/safecheck.html?flag=1&url=https://jtvx518.cc

**修复方法：**

- 在控制页面转向的地方校验传入的 URL 是否为可信域名。
- 接入防御JS代码 https://js.aq.qq.com/js/aq_common.js

**漏洞检测：**
修改参数中的合法URL为非法URL，然后查看是否能正常跳转或者响应包是否包含了任意的构造URL

### target="_blank" 存在跳转风险

带有 target="_blank" 跳转的网页拥有了浏览器 window.opener 对象赋予的对原网页的跳转权限，这可能会被恶意网站利用，例如一个恶意网站在某 UGC 网站 Po 了其恶意网址，该 UGC 网站用户在新窗口打开页面时，恶意网站利用该漏洞将原 UGC 网站跳转到伪造的钓鱼页面，用户返回到原窗口时可能会忽视浏览器 URL 已发生了变化，伪造页面即可进一步进行钓鱼或其他恶意行为...

**修复方法：** 为 target="_blank" 加上 rel="noopener noreferrer" 属性。

### JQUERY的下列方法存在XSS的风险，在使用前应该对输入的内容进行编码或检查

```html
.html(val) | $("#MyH").html("as>/" <img src=abc.jpg onerror='alert(0);'>alert('s');"); .append(val)|$("#MyH").append("<strong>Hello</strong><script>alert(3);"); . prepend(val)|$("#MyH").prepend("<strong>Hello</strong><script>alert(3);"); . before(val)|$("#MyH").before("<strong>Hello</strong><script>alert(3);"); .replaceWith(val)|$("#MyH").replaceWith("<strong>Hello</strong><script>alert(3);"); . after(val)|$("#MyH").after("<strong>Hello</strong><script>alert(3);");
```

**修复方法：**

- 在使用前应该对输入的内容进行编码或检查
- 使用.text()方法替换.html()方法操作元素内容

### 防御/修复方法

- 接入防御JS代码 https://js.aq.qq.com/js/aq_common.js
- 使用https协议，页面中的资源的引用目前使用自适应的写法

# 视口（viewport）基础知识

了解视口知识，有助于选择合适的移动端页面适配的方式。

### 基本名词解释

- **屏幕尺寸**

  表示屏幕对角线的长度，单位为英寸(in)，1英寸等于2.54厘米。例如：iPhone6的屏幕尺寸为4.7英寸。[屏幕尺寸参考大全](http://screensiz.es/)

- **设备像素DP(device pixels)**

  又称物理像素（physical pixel），是显示器设备上的一个物理像素点，系统可以通过控制每个像素点的颜色，使屏幕显示出不同的图像，每个设备的物理像素点是固定的，单位pt。

- **分辨率**

  表示设备屏幕在水平和垂直方向上的物理像素个数。例如，iPhone6的分辨率为750pt * 1334pt。

- **每英寸像素PPI（pixel per inch）**

  每英寸屏幕内有多少个设备像素点（物理像素），即像素密度（pixel density）。PPI的值越高，画质越好，画面越细腻 计算公式为：PPI = （横向像素^2 +纵向像素^2 ）^0.5 /屏幕尺寸。例如：iPhone6的像素密度等于 （750^2 +1334^2 ）^0.5/4.7 = 326。

- **设备独立像素DIP（device-independent pixel，density-independent pixel）**

  也叫密度无关像素，独立于设备的用于逻辑上衡量像素的单位，可以认为是计算机坐标系统中的一个点，这个点代表一个可以由程序使用并控制的虚拟像素，然后由相关系统转换为物理像素。

- **CSS 像素**

  又称为虚拟像素，设备独立像素的一种，是一种抽象单位，也可以理解为直觉像素。CSS 像素是 Web 编程的概念，指的是 CSS 样式代码中使用的逻辑像素。 CSS像素 = 设备独立像素 = 逻辑像素

- **设备像素比DPR(device pixel ratio)**

  未缩放状态下，设备像素和 CSS 像素的初始比例关系，也可以解释为默认缩放比例。 DPR计算公式：DPR = 设备像素/CSS像素。 可以通过`window.devicePixelRatio`获取移动设备的像素比。

- **viewport相关的 CSS 单位**

  - vw – 视区（视口）宽度百分值，Viewport's Width 简写，1vw 等于 window.innerWidth 的 1%
  - vh – 视区高度百分值，Viewport's Height 简写，1vh 等于 window.innerHeight 的 1%
  - vmin – vw或vh，取小的那个
  - vmax – vw或vh，取大的那个

### 三个viewport概念

- **布局视口layout viewport**

  表示浏览器默认的viewport，一般情况下这个宽度要大于浏览器可视区域宽度；

  获取方式：`document.documentElement.clientWidth/Height`可以获取layout viewport的尺寸

- **可视视口visual viewport**

  表示浏览器可视区域的大小，当用户缩小或者放大的时候，尺寸会发生变化。

  获取方式：通过`window.innerWidth/Height`

- **理想视口ideal viewport**

  最适合移动设备的viewport，它没有一个固定的尺寸，不同的设备拥有有不同的 ideal viewport，它的宽度等于移动设备的屏幕宽度(即设备逻辑像素)

  ideal viewport的宽度 = 屏幕的逻辑像素宽度

  ```html
  <meta name="viewport" content="width=device-width" />
  ```

### viewport的meta

移动端常用的viewport设置如下

```html
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
```

意思是强制让文档的宽度与设备的宽度保持1:1，并且文档最大的宽度比例是1.0，且不允许用户点击屏幕放大浏览。其中：

- width：设置布局视口的宽
- init-scale：设置页面的初始缩放程度
- minimum-scale：设置了页面最小缩放程度
- maximum-scale：设置了页面最大缩放程度
- user-scalable：是否允许用户对页面进行缩放操作

### viewport渲染流程

1. 渲染——将整个页面渲染在一个layout viewport中，以保证页面排版正确。
2. 缩放——将整个layout viewport缩放到visual viewport大小，以保证页面在手机屏幕上被完整显示出来

### JS获取当前屏幕宽高

Javascript:

网页可见区域宽： document.body.clientWidth
网页可见区域高： document.body.clientHeight
网页可见区域宽： document.body.offsetWidth (包括边线的宽)
网页可见区域高： document.body.offsetHeight (包括边线的高)
网页正文全文宽： document.body.scrollWidth
网页正文全文高： document.body.scrollHeight
网页被卷去的高： document.body.scrollTop
网页被卷去的左： document.body.scrollLeft
网页正文部分上： window.screenTop
网页正文部分左： window.screenLeft
屏幕分辨率的高： window.screen.height
屏幕分辨率的宽： window.screen.width
屏幕可用工作区高度： window.screen.availHeight
屏幕可用工作区宽度： window.screen.availWidth

 

JQuery:

$(document).ready(function(){
alert($(window).height()); //浏览器当前窗口可视区域高度
alert($(document).height()); //浏览器当前窗口文档的高度
alert($(document.body).height());//浏览器当前窗口文档body的高度
alert($(document.body).outerHeight(true));//浏览器当前窗口文档body的总高度 包括border padding margin

alert($(window).width()); //浏览器当前窗口可视区域宽度
alert($(document).width());//浏览器当前窗口文档对象宽度
alert($(document.body).width());//浏览器当前窗口文档body的宽度
alert($(document.body).outerWidth(true));//浏览器当前窗口文档body的总宽度 包括border padding margin

})

# 移动端适配

### rem布局

>  **提示**
>
> 规范只列举了rem布局这一种适配方式，但不是说限制只能用这种布局方式。 无论用何种方式，需要保证在不同比例、不同尺寸的手机上，测试微信、手Q、safari、UC等主流浏览器无明显错位、变形。

### viewport

```html
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
```

### 初始字号

css中设定html根元素的初始字体大小为100px

```css
html{font-size:100px;}
```

### 单位转换

不管你拿到的设计稿宽度是640px还是750px，多大都一样。和我们平时做PC页面的做法基本一样，只需要把单位px换算成rem，所有设计稿的的元素大小全除以100单位换成rem，例如设计稿上个某个文字的大小为30px，直接写font-size:0.3rem。

### 注意事项

使用rem方式布局有以下几点需要注意：

- 页面用不同尺寸的手机进行测试
- 因为小于1px浏览器支持不够好为会导致计算会有误差，背景图使用雪碧图时，图标之间多留5px的空隙，同时图片的backgrornd-size属性最好写上图片的宽高，不写误差更大。　
- 雪碧图，如图片宽高为346px*160px需要设置background-size属性设置为background-size: 3.46rem 1.6rem;
- 大小为1px的元素不要使用rem，直接用px
- 多栏多列布局优先使用百分比`%`或是`display:flex`



一般rem布局能比较精确的还原设计页面，此外，不推荐通过transform:scale | zoom的方式进行缩放的方式适配，可能会出现模糊、容器外弹窗缩放比例不正确、滚动异常等情况。

## 媒体查询

**判断设备横竖屏**

```css
/* 横屏 */
@media all and (orientation :landscape) {

} 

/* 竖屏 */
@media all and (orientation :portrait) {

}
```

**判断设备宽高**

```css
/* 设备宽度大于 320px 小于 640px */
@media all and (min-width:320px) and (max-width:640px) {
    
}
```

**判断设备像素比**

```css
/* 设备像素比为 1 */
@media only screen and (-webkit-min-device-pixel-ratio: 1), only screen and (min-device-pixel-ratio: 1) {
    
}

/* 设备像素比为 1.5 */
@media only screen and (-webkit-min-device-pixel-ratio: 1.5), only screen and (min-device-pixel-ratio: 1.5) {
    
}

/* 设备像素比为 2 */
@media only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min-device-pixel-ratio: 2) {
    
}
```

## 常用设备设置

### iPhones

```css
/* ----------- iPhone 4 and 4S ----------- */

/* Portrait and Landscape */
@media only screen 
  and (min-device-width: 320px) 
  and (max-device-width: 480px)
  and (-webkit-min-device-pixel-ratio: 2) {

}

/* Portrait */
@media only screen 
  and (min-device-width: 320px) 
  and (max-device-width: 480px)
  and (-webkit-min-device-pixel-ratio: 2)
  and (orientation: portrait) {
}

/* Landscape */
@media only screen 
  and (min-device-width: 320px) 
  and (max-device-width: 480px)
  and (-webkit-min-device-pixel-ratio: 2)
  and (orientation: landscape) {

}

/* ----------- iPhone 5 and 5S ----------- */

/* Portrait and Landscape */
@media only screen 
  and (min-device-width: 320px) 
  and (max-device-width: 568px)
  and (-webkit-min-device-pixel-ratio: 2) {

}

/* Portrait */
@media only screen 
  and (min-device-width: 320px) 
  and (max-device-width: 568px)
  and (-webkit-min-device-pixel-ratio: 2)
  and (orientation: portrait) {
}

/* Landscape */
@media only screen 
  and (min-device-width: 320px) 
  and (max-device-width: 568px)
  and (-webkit-min-device-pixel-ratio: 2)
  and (orientation: landscape) {

}

/* ----------- iPhone 6 ----------- */

/* Portrait and Landscape */
@media only screen 
  and (min-device-width: 375px) 
  and (max-device-width: 667px) 
  and (-webkit-min-device-pixel-ratio: 2) { 

}

/* Portrait */
@media only screen 
  and (min-device-width: 375px) 
  and (max-device-width: 667px) 
  and (-webkit-min-device-pixel-ratio: 2)
  and (orientation: portrait) { 

}

/* Landscape */
@media only screen 
  and (min-device-width: 375px) 
  and (max-device-width: 667px) 
  and (-webkit-min-device-pixel-ratio: 2)
  and (orientation: landscape) { 

}

/* ----------- iPhone 6+ ----------- */

/* Portrait and Landscape */
@media only screen 
  and (min-device-width: 414px) 
  and (max-device-width: 736px) 
  and (-webkit-min-device-pixel-ratio: 3) { 

}

/* Portrait */
@media only screen 
  and (min-device-width: 414px) 
  and (max-device-width: 736px) 
  and (-webkit-min-device-pixel-ratio: 3)
  and (orientation: portrait) { 

}

/* Landscape */
@media only screen 
  and (min-device-width: 414px) 
  and (max-device-width: 736px) 
  and (-webkit-min-device-pixel-ratio: 3)
  and (orientation: landscape) { 

}
```

### Galaxy Phones

```css
/* ----------- Galaxy S3 ----------- */

/* Portrait and Landscape */
@media screen 
  and (device-width: 320px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 2) {

}

/* Portrait */
@media screen 
  and (device-width: 320px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 2) 
  and (orientation: portrait) {

}

/* Landscape */
@media screen 
  and (device-width: 320px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 2) 
  and (orientation: landscape) {

}

/* ----------- Galaxy S4 ----------- */

/* Portrait and Landscape */
@media screen 
  and (device-width: 320px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) {

}

/* Portrait */
@media screen 
  and (device-width: 320px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) 
  and (orientation: portrait) {

}

/* Landscape */
@media screen 
  and (device-width: 320px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) 
  and (orientation: landscape) {

}

/* ----------- Galaxy S5 ----------- */

/* Portrait and Landscape */
@media screen 
  and (device-width: 360px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) {

}

/* Portrait */
@media screen 
  and (device-width: 360px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) 
  and (orientation: portrait) {

}

/* Landscape */
@media screen 
  and (device-width: 360px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) 
  and (orientation: landscape) {

}
```

### HTC Phones

```css
/* ----------- HTC One ----------- */

/* Portrait and Landscape */
@media screen 
  and (device-width: 360px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) {

}

/* Portrait */
@media screen 
  and (device-width: 360px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) 
  and (orientation: portrait) {

}

/* Landscape */
@media screen 
  and (device-width: 360px) 
  and (device-height: 640px) 
  and (-webkit-device-pixel-ratio: 3) 
  and (orientation: landscape) {

}
```

### iPads

```css
/* ----------- iPad mini ----------- */

/* Portrait and Landscape */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (-webkit-min-device-pixel-ratio: 1) {

}

/* Portrait */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (orientation: portrait) 
  and (-webkit-min-device-pixel-ratio: 1) {

}

/* Landscape */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (orientation: landscape) 
  and (-webkit-min-device-pixel-ratio: 1) {

}

/* ----------- iPad 1 and 2 ----------- */

/* Portrait and Landscape */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (-webkit-min-device-pixel-ratio: 1) {

}

/* Portrait */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (orientation: portrait) 
  and (-webkit-min-device-pixel-ratio: 1) {

}

/* Landscape */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (orientation: landscape) 
  and (-webkit-min-device-pixel-ratio: 1) {

}

/* ----------- iPad 3 and 4 ----------- */

/* Portrait and Landscape */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (-webkit-min-device-pixel-ratio: 2) {

}

/* Portrait */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (orientation: portrait) 
  and (-webkit-min-device-pixel-ratio: 2) {

}

/* Landscape */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (orientation: landscape) 
  and (-webkit-min-device-pixel-ratio: 2) {

}
```

**如果横竖都需要兼容，分两种情况**

- 页面没有滚动内容 此时可使用css3旋转屏幕的方式

- 页面有滚动区域 分两种情况

  1. 使用CSS的媒体查询功能对非当前设计的屏幕方向给予提示，提示用户手动旋转屏幕。

     **提示竖屏**

     ```css
     @media all and (orientation:landscape){
       html,body{position:relative;overflow:hidden;width:100%;height:100%;padding:0;margin:0;}
       html::before{content:"";position:fixed;top:0;left:0;height:100%;width:100%;background:#333;z-index:99999;}
       html::after{content:"\4E3A\4E86\66F4\597D\7684\4F53\9A8C\FF0C\8BF7\5C06\624B\673A\7AD6\8FC7\6765";text-align:center;font-size:16px;color:#fff;position:absolute;top:50%;left:0;height:30px;width:100%;margin-top:50px;z-index:99999;}
       body::before{content:"";position:absolute;z-index:99999;height:200px;width:100px;left:50%;top:50%;margin:-140px 0 0 -50px;color:#fff;background-image:url("图片url");background-repeat:no-repeat;background-position:center center;background-size:100px auto;-webkit-transform:rotateZ(-90deg);}
     }
     ```

     **提示横屏**

     ```css
     @media all and (orientation:portrait){
       html,body{position:relative;overflow:hidden;width:100%;height:100%;padding:0;margin:0;}
       html::before{content:"";position:fixed;top:0;left:0;height:100%;width:100%;background:#333;z-index:99999;}
       html::after{content:"\4E3A\4E86\66F4\597D\7684\4F53\9A8C\FF0C\8BF7\5C06\624B\673A\6A2A\8FC7\6765";position:absolute;top:50%;left:0;height:30px;width:100%;margin-top:30px;z-index:99999;text-align:center;font-size:16px;color:#fff;}
       body::before{content:"";position:absolute;z-index:99999;height:200px;width:100px;left:50%;top:50%;margin:-160px 0 0 -50px;color:#fff;background-image:url("图片url");background-repeat:no-repeat;background-position:center center;background-size:100px auto;}
     }
     ```

     

  2. 如果项目横竖屏都能正常使用，设计稿阶段需要有两版，分别对应横屏竖屏，然后前端重构使用CSS媒体查询对页面元素进行横竖适配。

### 官网页面

官网可看作是专题的一个特殊分类，所以上面对于专题页面的适配方式也适用于官网页面。但在实际项目中，还有这些点需要注意：

- 新闻列表标题长度不定，需要做自适应处理。如超过一行之后自动换行，高度自适应；或者超出内容用省略号显示。

  ```css
  /* 超出一行用省略号显示 */
  .title{
    overflow:hidden;
    white-space:nowrap;
    text-overflow:ellipsis;
  }
  /* 超出2行用省略号显示 */
  .title{
    overflow:hidden;
    display:-webkit-box;
    -webkit-line-clamp:2;
    -webkit-box-orient:vertical;
    text-overflow:ellipsis;
  }
  ```

- 官网页面的生命周期比普通专题更长，需要特别注意后期的可维护性，例如：

  - 版块的增减是否会影响页面整体的布局

  - tab的数量是很可能会增减的，每个tab的宽度不要写死，推荐flex布局。

    > [我们就来谈谈Flexbox布局](https://tgideas.qq.com/gicp/news/475/6515231.html) by 小刀@tgideas

  - 版块的标题，在设计阶段就需要注意，尽量不要使用特殊字体和不可延展的背景。重构在写页面的时候就能使用系统默认字体，且方便对不同长度的标题做自适应处理。

# 移动端常用私有属性

目前两大主流移动平台为 `iOS` 和 `Android`，有不少带 `-webkit-` 前辍的 CSS 私有属性以及一些 iOS only 属性，当中好些属性在日常需求中经常应用到。

`WebKit` CSS 属性中的一部分已经被包含在 CSS 规范草案中，并且可能成为最后的推荐标准，但目前仍然是试验性的属性，还有一些属性是不规范的属性，它们没有出现在跟踪规范中。

## -webkit-scrollbar

`-webkit-scrollbar` 是-webkit-私有的伪元素，用于对拥有overflow属性的区域 **自定义滚动条的样式**。

譬如，为了隐藏滚动条，你可以这么做：

```
.scroll::-webkit-scrollbar {
    width: 0;
    height: 0;
}
```



除了对整个滚动条的控制外，Webkit还提供了控制对滚动条各组成部分的表现渲染的伪元素，甚至具体到滚动条的各种状态行为的伪类。

### 滚动条各块组成表现渲染的伪元素

一般而言，滚动条的主要组成部分包括：

- 滚动按钮 — 滚动按钮的夹角则被称为滚动角(corner)。
- 轨道 — 轨道(track)可以进一步分为轨枕(track pieces) 和滑块(thumb)。

Webkit则根据滚动条各组成部分，提供了不同的伪元素来自定义样式。

```
::-webkit-scrollbar              { /* 1 */ }
::-webkit-scrollbar-button       { /* 2 */ }
::-webkit-scrollbar-track        { /* 3 */ }
::-webkit-scrollbar-track-piece  { /* 4 */ }
::-webkit-scrollbar-thumb        { /* 5 */ }
::-webkit-scrollbar-corner       { /* 6 */ }
::-webkit-resizer                { /* 7 */ }
```



下图则是各伪元素对应的滚动条各部分：

![scrollbarparts.png](http://7xs2jo.com1.z0.glb.clouddn.com/215F9FF68F2CAE78957E1C112521A0A2.png)

`::-webkit-scrollbar`：滚动条整体部分。可设置width、height、background、border等。

`::-webkit-scrollbar-button`：滚动条两端的按钮。可以用display:none让其不显示，也可以添加背景图片，颜色改变显示效果。

`::-webkit-scrollbar-track`：轨道。可以用display:none让其不显示，也可以添加背景图片，颜色改变显示效果。

`::-webkit-scrollbar-track-piece`：轨枕，也就是除去滚动滑块的部分。

`::-webkit-scrollbar-thumb`：滚动滑块，也就是滚动条里面可以拖动的那部分。

`::-webkit-scrollbar-corner`：滚动按钮的夹角则被称为滚动角。

`::-webkit-resizer`：用于定义右下角拖动块的样式。

**需要注意的是**：若是水平滚动条，则width属性不起作用，height属性用来控制滚动条相应部分竖直方向高度；若是竖直滚动条，则height属性不起作用，width属性用来控制相应部分的宽度。

### 滚动条各块组成的伪元素

下面的伪类可以应用到上面的伪元素中。
`:horizontal`：选择水平方向的滚动条。

`:vertical`：选择垂直方向的滚动条。

`:decrement`：适用于滚动按钮和轨枕。选择能够使得视窗位置递减状态(例如，垂直滚动条向上滚动，水平滚动条向左滚动。)的滚动按钮或轨枕。

`:increment`：适用于滚动按钮和轨枕。选择能够使得视窗位置递增状态(例如，垂直滚动条向下滚动，水平滚动条向右滚动。)的滚动按钮或轨枕。

`:start`：适用于滚动按钮和轨枕。选择位于滚动滑块前边的滚动按钮和轨枕。

`:end`：适用于滚动按钮和轨枕。选择位于滚动滑块后边的滚动按钮和轨枕。

`:double-button`：适用于滚动按钮和轨枕。选中紧挨着一对按钮的轨枕以及位于滚动条某一端的一对按钮中的其中一个滚动按钮。

`:single-button`：适用于滚动按钮和轨枕。选中紧挨着仅一个按钮的轨枕以及位于滚动条某一端的仅它本身一个的滚动按钮。

`:no-button`：适用于轨枕。选中轨道结束位置没有按钮的轨枕。

`:corner-present`：适用于选中滚动角不存在的滚动条。

`:window-inactive`：适用于所有滚动条，选中焦点不在该视窗的滚动区域。

**另外，:enabled、:disabled、:hover、和:active等伪类同样在滚动条中适用。**
为了更好地理解，以下是几个伪元素组合伪类的应用例子：

```
::-webkit-scrollbar-track-piece:start {
 /\*滚动条上半边或左半边\*/
}
::-webkit-scrollbar-thumb:window-inactive {
 /\*当焦点不在当前区域滑块的状态\*/

::-webkit-scrollbar-button:horizontal:decrement:hover {
 /\*当鼠标在水平滚动条下面的按钮上的状态\*/
```



或者，读者可以去阅读[官方例子](http://trac.webkit.org/export/41842/trunk/LayoutTests/scrollbars/overflow-scrollbar-combinations.html)

#### 参考资料：

- [Webkit-Styling Scrollbars](https://webkit.org/blog/363/styling-scrollbars/)
- [自定义浏览器滚动条的样式，打造属于你的滚动条风格](http://www.lyblog.net/detail/314.html)

## -webkit-touch-callout

`-webkit-touch-callout` 是一个不规范的属性（[unsupported WebKit property](https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html)），它没有出现在 CSS 规范草案中。

当你触摸并按住触摸目标时候，禁止或显示系统默认菜单。在iOS上，当你触摸并按住触摸的目标，比如一个链接，Safari浏览器将显示链接有关的系统默认菜单，这个属性可以让你禁用系统默认菜单。

### 属性值

- `none`：系统默认菜单被禁用
- `inherit`：系统默认菜单不被禁用

### 兼容性

- iOS 2.0及更高版本的 Safari 浏览器可用
- Android 尚不明确

## -webkit-tap-highlight-color

`-webkit-tap-highlight-color` 是一个不规范的属性（[unsupported WebKit property](https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html)），它没有出现在 CSS 规范草案中。

在 iOS Safari 上，当用户点击链接或具有 JavaScript 可点击脚本的元素，系统会为这些被点击元素加上一个默认的透明色值，该属性可以覆盖该透明值。

### 属性值

<color>：颜色值

### 兼容性

- iOS 1.1.1及更高版本的Safari浏览器可用
- 大部分安卓手机

## -webkit-overflow-scrolling

定义在具 `overflow:scroll` 属性的元素内是否采用原生样式滚动行为

### 属性值

- `auto`：默认值，单手滚动，滚动没有惯性效果
- `touch`：原生样式滚动，应用此属性值会产生**层叠上下文**（会影响定位参照物的属性，类似 `opacity`、`masks`、`transforms`属性，影响到 `position` 的效果，甚至影响到 `position:fixed` 的定位参照物，）

### 兼容性

- iOS 5.0 及更高版本
- 大部分安卓机

## -webkit-line-clamp

`-webkit-line-clamp` 是一个不规范的属性（[unsupported WebKit property](https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html)），它没有出现在 CSS 规范草案中。

限制在一个块元素显示的文本的行数。 为了实现该效果，它需要组合其他外来的WebKit属性。

常见结合属性：

- `display: -webkit-box`：**必须结合的属性**，将对象作为弹性伸缩盒子模型显示。
- `-webkit-box-orient`：**必须结合的属性**，设置或检索伸缩盒对象的子元素的排列方式。
- `text-overflow`：可以用来多行文本的情况下，用省略号“…”隐藏超出范围的文本。

### 属性值

<number>：块元素显示的文本的行数

### 兼容性

- iOS
- Andriod

## -webkit-appearance

`-webkit-appearance` 是一个不规范的属性（[unsupported WebKit property](https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html)），它没有出现在 CSS 规范草案中。

改变按钮和其他控件的外观，使其类似于原生控件。

### 属性值

- `none`：去除系统默认 appearance 的样式，常用于 iOS 下移除原生样式
- `button`：渲染成 button 的风格
- `checkbox`：渲染成 input checkbox 样式的复选框按钮
- `radio`：渲染成 radio 的风格
- …

更多属性值参考 [mozilla：-webkit-appearance 属性](https://developer.mozilla.org/en-US/docs/Web/CSS/-moz-appearance)

### 兼容性

- iOS 2.0及更高版本的Safari浏览器可用
- Android 尚不明确

## -webkit-font-smoothing

字体平滑，该属性定义文本的平滑属性，但要**注意以下说明：**

> 非标准属性，**不建议用于网页上**，这个属性不能保证所有用户都能看到相同效果，这会使网站的字体渲染造成不一致，而此属性的渲染行为日后也有可能会改变

### 属性值

- `none`：去掉字体平滑效果，使字体带锯齿
- `antialiased`：使字体在像素级别更平滑更轻细
- `subpixel-antialiased`：在多数非 Retina 显示设备中字体将会更锐利。

**注意：以上属性在 Retina 设备上会有明显的效果，在非 Retina 设备上看不出差异**

### 兼容性

- 部分高清设备，如 Retina Mac

## -webkit-backface-visibility

`backface-visibility` 在 [W3文档](http://www.w3.org/TR/css3-transforms/#backface-visibility-property) 有定义描述

定义转换元素的背面是否显示

### 属性值

- `visible`：显示（默认值）
- `hidden`：隐藏

### 兼容性

- iOS 2.0 及更高版本的 Safari 浏览器可用
- 大部分 Android

## -webkit-mask

定义多样的蒙板效果属性（缩写属性，类似 `margin`）

### 使用语法

```
<mask-image> [<mask-repeat> || <mask-attachment> || <mask-position> || <mask-origin> || <mask-clip> || <mask-composite>]*
where 
<mask-position> = [ <percentage> | <length> | left | center | right ] [ <percentage> | <length> | top  | center | bottom ]?
```

默认值：

```
-webkit-mask: none repeat scroll 0% 0% padding border add;
```

### 属性值

- <mask-image>：为元素设置蒙板图片，蒙板图片会根据图片的透明区域对元素可视部分进行裁剪
  - <uri>：图片链接作为蒙板图片
  - <gradient>：渐变函数 `-webkit-gradient` 作为蒙板图片
  - `none`：去掉蒙板图片
- <mask-repeat>：定义蒙板图片是否平铺或平铺的方式
  - `repeat`：默认值，水平和垂直方向平铺
  - `repeat-x`：水平方向平铺
  - `repeat-y`：垂直方向平铺
  - `no-repeat`：不平铺
- <mask-attachment>：如果 `-webkit-mask-image` 属性有设置，`attachment` 决定该图片是否相对视窗固定或随着其容器滚动
  - `scroll`：默认值，随容器滚动
  - `fixed`：相地视窗固定
- <mask-position>：定义蒙板图片的初始位置，书写格式类似 `background-position`—-`<mask-position>[， <mask-position>]*`
  - <percentage>
  - <length>
  - `left`
  - `right`
  - `center`
- <mask-origin>：定义蒙板图片定位相对起点，与 `webkit-mask-position` 属性相关。当 `-webkit-mask-attachment:fixed` 的时候，该属性不生效。
  - `padding`：默认值，蒙板定位相对边距
  - `border`：蒙板定位相对边框
  - `content`：蒙板定位相对元素盒子内容
- <mask-clip>：如果 `-webkit-mask-image` 属性有设置，`-webkit-mask-clip` 将定义蒙板图片的裁剪区域
  - `border`：默认值，蒙板图片延伸到容器的边框
  - `padding`：蒙板图片延伸到容器的边距
  - `content`：蒙板图片裁剪到元素盒子内容范围
  - `text`：蒙板图片裁剪到元素文本范围
- <mask-composite>：定义蒙板图片重合的裁剪显示方式
  - `add`：默认值，图片重合不裁剪
  - `subtract`：去掉层级低的图形以及图片重合部分图形，只留层级高非重合部分图形
  - `intersect`：只留重合部分图形
  - `exclude`：只去掉重合部分图形

有关属性更详细描述请参考：

[w3 - css-masking](http://www.w3.org/TR/css-masking/)

[MDN - -webkit-mask](https://developer.mozilla.org/en-US/docs/Web/CSS/-webkit-mask)

[携程 UED - -webkit-mask](http://ued.ctrip.com/webkitcss/)

### 兼容性

- Safari 4.0 及更高版本
- iOS 4.0 及更高版本
- Android 2.1 及更高版本

## -webkit-user-select

定义用户是否能选中元素内容

### 属性值

- `auto`：可选中元素内容
- `none`：不能选中任何内容
- `text`：可选中元素内的文本

### 兼容性

- iOS 3.0 及更高版本的 Safari
- 大部分安卓手机

## -webkit-user-modify

定义用户是否可编辑元素内容

### 属性值

- `read-only`：只读
- `read-write`：可读可写，粘贴内容会保留富文本格式（ Android 机不保留富文本格式 ）
- `read-write-plaintext-only`：可读可写，粘贴内容所有富文本格式都会丢失

**注意：使用这个属性的时候，请不要出现 `-webkit-user-select: none`，文本无法选中的情况下，在 Safari 该属性不生效，不过在 Chrome 依然生效**

### 兼容性

- iOS 5.0 及更高版本
- Safari 3.0 及更高版本
- 大部分安卓手机

## -webkit-text-stroke

定义文本描边，可以设计描边的宽和颜色，一般与文本填充属性 `-webkit-text-fill-color` 共用。

### 属性值

- <length>：长度单位
- <color>：颜色值

### 兼容性

- iOS 2.0 及更高版本
- Safari 3.0 及更高版本
- 安卓尚不明确

## -webkit-text-fill-color

定义文本填充，一般与文本描边属性 `-webkit-text-stroke` 共用。

### 属性值

- <color>：颜色值
- `currentcolor`：元素 `color` 属性值
- `-webkit-activelink`：链接被点击时系统的默认颜色

更多属性值参考：[Safari CSS Reference -webkit-text-fill-color](https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html)

### 兼容性

- iOS 2.0 及更高版本
- Safari 3.0 及更高版本
- 安卓尚不明确

## -webkit-text-size-adjust

定义 iOS Safari 网页文本大小调整属性

### 属性值

- <percentage>：百分比值，字体显示调整值
- `auto`：字体自动调整
- `none`：字体不能自动调整

### 兼容性

- iOS 1.0 及更高版本
- Safari on iOS only
- 安卓尚不明确

## -webkit-marquee

定义滚动文本内容属性（缩写属性，类似`margin`）。

### 使用语法

```
-webkit-marquee: direction increment repetition style speed
```

### 属性值

- <direction>：滚动方向
  - `ahead`：从下到上滚动
  - `auto`：默认滚动方向
  - `backwards`：从右到左滚动
  - `down`：从上到下滚动
  - `forwards`：从左到右滚动
  - `left`：从右到左滚动
  - `reverse`：从上到下滚动
  - `right`：从左到右滚动
  - `up`：从下到上滚动
- <increment>：每次移动的距离
  - [<percentage> | <length>]
  - `large`：距离常量
  - `medium`：距离常量
  - `small`：距离常量
- <repetition>：文字滚动的重复次数
  - 非负整数
  - `infinite`：无限次
- <style>：文字滚动的方式
- <speed>：滚动或滑动的速度
  - 非负整数（毫秒单位）或带时间单位的非负整数
  - `fast`
  - `normal`
  - `slow`

### 兼容性

- iOS 1.0 及更高版本
- Safari 3.0 及更高版本
- 大部分安卓手机

## -webkit-filter

滤镜属性可以让元素本身内容（文本、背景等）及其子元素加上滤镜效果

### 属性值

- `blur(<length>)`：模糊，原始效果值为 `0px`，不接受负值
- `brightness([ <number> | <percentage> ])`：亮度，原始效果值为 `1` 或 `100%`，不接受负值
- `contrast([ <number> | <percentage> ])`：对比度，原始效果值为 `1` 或 `100%`，不接受负值
- `drop-shadow( <length>{2，4} <color>?)`：投影，原始效果值为所有长度值为 `0`，长度值至少2个，最多4个，
- `grayscale([ <number> | <percentage> ] )`：灰度，原始效果值为 `0`，最大值为 `1` 或 `100%`，不接受负值
- `hue-rotate( <angle>)`：相位，原始效果值为 `0deg`
- `invert( [ <number> | <percentage> ])`：反相，原始效果值为 `0`，最大值为 `1` 或 `100%`，不接受负值
- `opacity([ <number> | <percentage> ] )`：透明度，原始效果值为 `1`，最大值为 `1` 或 `100%`，不接受负值
- `saturate([ <number> | <percentage> ])`：饱和度，原始效果值为 `1`，不接受负值
- `sepia([ <number> | <percentage> ])`：乌贼墨，原始效果值为 `0`，最大值为 `1` 或 `100%`，不接受负值

关于 `-webkit-filter` 与 `-webkit-backdrop-filter` 的属性对比可以参考：

[What’s New in Safari 9.0 - backdrop-filter](http://aotu.io/notes/2015/12/23/new-safari-9/)

### 兼容性

- iOS 8.0 及更高版本
- Safari 8.0 及更高版本
- Android 4.4 及更高版本

## -webkit-backdrop-filter

背景滤镜属性可以让元素的背景或元素层级以下的元素加上滤镜效果

### 属性值

- `blur(<length>)`：模糊，原始效果值为 `0px`，不接受负值
- `brightness([ <number> | <percentage> ])`：亮度，原始效果值为 `1` 或 `100%`，不接受负值
- `contrast([ <number> | <percentage> ])`：对比度，原始效果值为 `1` 或 `100%`，不接受负值
- `drop-shadow( <length>{2，3} <color>?)`：投影，原始效果值为所有长度值为 `0`，长度值至少2个，最多3个，**注意：不支持投影扩展值和混合投影**
- `grayscale([ <number> | <percentage> ] )`：灰度，原始效果值为 `0`，最大值为 `1` 或 `100%`，不接受负值
- `hue-rotate( <angle>)`：相位，原始效果值为 `0deg`
- `invert( [ <number> | <percentage> ])`：反相，原始效果值为 `0`，最大值为 `1` 或 `100%`，不接受负值
- `opacity([ <number> | <percentage> ] )`：透明度，原始效果值为 `1`，最大值为 `1` 或 `100%`，不接受负值
- `saturate([ <number> | <percentage> ])`：饱和度，原始效果值为 `1`，不接受负值
- `sepia([ <number> | <percentage> ])`：乌贼墨，原始效果值为 `0`，最大值为 `1` 或 `100%`，不接受负值

关于 `-webkit-filter` 与 `-webkit-backdrop-filter` 的属性对比可以参考：

[What’s New in Safari 9.0](http://aotu.io/notes/2015/12/23/new-safari-9/)

### 兼容性

- iOS 9.0 及更高版本
- Safari 9.0 及更高版本
- 安卓尚未明确

## position:-webkit-sticky

可以使得元素在页面没有滚动的情况下表现得像relative，在滚动条滚到该元素区域的时候根据top值的设置使元素固定离顶部的距离，表现像 `position:fixed`，也就是常见的吸顶需求效果。

### 特性

- 依赖父级元素滚动区域
- 定位参考物始终是 viewport，`transform` 等可以改变 `position:fixed` 定位参考物的属性也没办法改变 `position:-webkit-sticky` 的定位参考物
- `position:-webkit-sticky` 属性的元素固定区域只依赖其父元素的可滚动高度，如果其父元素高度小于元素本身的高度，fixed效果失效。

### 兼容性

- iOS 6.1 及更高版本
- iOS only

## -apple-system

苹果操作系统会从两种不同外观和大小的字体进行自动转换去调节系统新字体 “San Francisco”，可以通过 CSS 规则

```
font-family: -apple-system , sans-serif;
```

让系统智能选择适配操作系统的字体，添加 `-apple-system` 可以使字体变得更圆润锐利。

关于 `-apple-system` 更详细的介绍可以参考：

[What’s New in Safari 9.0](http://aotu.io/notes/2015/12/23/new-safari-9/)

### 兼容性

- iOS 9.0 及更高版本
- Safari 9.0 及更高版本
- iOS / OS X only

## 更多 WebKit CSS 属性

更多 `-webkit-` CSS 属性介绍请参考：

- [MDN文档 - Webkit Extensions](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Reference/Webkit_Extensions)
- [携程 UED - webkitcss](http://ued.ctrip.com/webkitcss/)

# 移动端事件介绍

移动端事件主要有触摸、滑动、点击、拖拽、双击、旋转、放大缩小，下面主要会介绍前三种事件。

### 触摸

- touchstart：手指触摸到屏幕会触发
- touchmove：当手指在屏幕上移动时，会触发
- touchend：当手指离开屏幕时，会触发
- touchcancel：可由系统进行的触发，比如手指触摸屏幕的时候，突然alert了一下，或者系统中其他打断了touch的行为，则可以触发该事件

### swipe类滑动事件

- swipe：手指在屏幕上滑动时会触发
- swipeLeft：手指在屏幕上向左滑动时会触发
- swipeRight：手指在屏幕上向右滑动时会触发
- swipeUp：手指在屏幕上向上滑动时会触发
- swipeDown：手指在屏幕上向下滑动时会触发

### 点击事件

#### tap

- 标准事件中没有tap事件，tap事件是zepto，使用touch进行封装的
- tap: 手指碰一下屏幕会触发
- longTap: 手指长按屏幕会触发
- singleTap: 手指碰一下屏幕会触发
- doubleTap: 手指双击屏幕会触发

#### click

- 移动端的click有300ms延迟的问题，在移动端浏览器中，连续两次点击是缩放操作，所以在用户点击屏幕后，浏览器会检查在300ms内是否有另一次点击，如果没有则触发click事件。因为有延迟，所以尽量不使用click做为点击事件
- 可以使用touchstart代替点击事件，但前提是同一对象上不能同时绑定一个单击事件和一个滑动事件

#### 点透问题

- 原因 当一个用户在点击屏幕的时候，系统会触发touch事件和click事件，touch事件优先处理，touch事件经过 捕获，处理, 冒泡 一系列流程处理完成后， 才回去触发click事件

- 场景 tap和click不能混用 A 和 B不是后代继承关系(如果是后代继承关系的话，就直接是冒泡子类的话题了) A发生touch， A touch后立即消失， B事件绑定click A z-index大于B，即A显示在B浮层之上

- 解决方案 可以touch阶段取消掉系统触发的click事件，也可以让消失的元素延迟200-300ms

  #### HTML代码 HTML codes

Copy

```html
<body>
    <div>
        <div id="A">
        </div>
        <div id="B">
        </div> 
    </div>
</body>
<script type="text/javascript">
var A = document.getElementById("A");
var B = document.getElementById("B");
A.addEventListener('touchstart', function(e) {
    A.style.display = 'none';
});
A.addEventListener('touchend', function(e) {
    e.preventDefault();
});
B.onclick = function() {
    console.log('兄弟元素B被点击了');
}
</script>
```

# web端事件介绍

**一般事件**

| 事件        | 浏览器支持  | 事件描述                                                     |
| ----------- | ----------- | ------------------------------------------------------------ |
| onClick     | IE3\|N2\|O3 | 鼠标点击事件，多用在某个对象控制的范围内的鼠标点击           |
| onDblClick  | IE4\|N4\|O  | 鼠标双击事件                                                 |
| onMouseDown | IE4\|N4\|O  | 鼠标上的按钮被按下了                                         |
| onMouseUp   | IE4\|N4\|O  | 鼠标按下后，松开时激发的事件                                 |
| onMouseOver | IE3\|N2\|O3 | 当鼠标移动到某对象范围的上方时触发的事件                     |
| onMouseMove | IE4\|N4\|O  | 鼠标移动时触发的事件                                         |
| onMouseOut  | IE4\|N3\|O3 | 当鼠标离开某对象范围时触发的事件                             |
| onKeyPress  | IE4\|N4\|O  | 当键盘上的某个键被按下并且释放时触发的事件.[注意:页面内必须有被聚焦的对象] |
| onKeyDown   | IE4\|N4\|O  | 当键盘上某个按键被按下时触发的事件[注意:页面内必须有被聚焦的对象] |
| onKeyUp     | IE4\|N4\|O  | 当键盘上某个按键被按放开时触发的事件[注意:页面内必须有被聚焦的对象] |


**页面相关事件 **

| 事件           | 浏览器支持  | 事件描述                                                     |
| -------------- | ----------- | ------------------------------------------------------------ |
| onAbort        | IE4\|N3\|O  | 图片在下载时被用户中断                                       |
| onBeforeUnload | IE4\|N\|O   | 当前页面的内容将要被改变时触发的事件                         |
| onError        | IE4\|N3\|O  | 捕抓当前页面因为某种原因而出现的错误，如脚本错误与外部数据引用的错误 |
| onLoad         | IE3\|N2\|O3 | 页面内空完成传送到浏览器时触发的事件，包括外部文件引入完成   |
| onMove         | IE\|N4\|O   | 浏览器的窗口被移动时触发的事件                               |
| onResize       | IE4\|N4\|O  | 当浏览器的窗口大小被改变时触发的事件                         |
| onScroll       | IE4\|N\|O   | 浏览器的滚动条位置发生变化时触发的事件                       |
| onStop         | IE5\|N\|O   | 浏览器的停止按钮被按下时触发的事件或者正在下载的文件被中断   |
| onUnload       | IE3\|N2\|O3 | 当前页面将被改变时触发的事件                                 |



**表单相关事件 **

| 事件     | 浏览器支持  | 事件描述                                                     |
| -------- | ----------- | ------------------------------------------------------------ |
| onBlur   | IE3\|N2\|O3 | 当前元素失去焦点时触发的事件 [鼠标与键盘的触发均可]          |
| onChange | IE3\|N2\|O3 | 当前元素失去焦点并且元素的内容发生改变而触发的事件 [鼠标与键盘的触发均可] |
| onFocus  | IE3\|N2\|O3 | 当某个元素获得焦点时触发的事件                               |
| onReset  | IE4\|N3\|O3 | 当表单中RESET的属性被激发时触发的事件                        |
| onSubmit | IE3\|N2\|O3 | 一个表单被递交时触发的事件                                   |



**滚动字幕事件**

| 事件     | 浏览器支持 | 事件描述                                               |
| -------- | ---------- | ------------------------------------------------------ |
| onBounce | IE4\|N\|O  | 在Marquee内的内容移动至Marquee显示范围之外时触发的事件 |
| onFinish | IE4\|N\|O  | 当Marquee元素完成需要显示的内容后触发的事件            |
| onStart  | IE4\|N\|O  | 当Marquee元素开始显示内容时触发的事件                  |


**编辑事件 **

| 事件              | 浏览器支持 | 事件描述                                                     |
| ----------------- | ---------- | ------------------------------------------------------------ |
| onBeforeCopy      | IE5\|N\|O  | 当页面当前的被选择内容将要复制到浏览者系统的剪贴板前触发的事件 |
| onBeforeCut       | IE5\|N\|O  | 当页面中的一部分或者全部的内容将被移离当前页面[剪贴]并移动到浏览者的系统剪贴板时触发的事件 |
| onBeforeEditFocus | IE5\|N\|O  | 当前元素将要进入编辑状态                                     |
| onBeforePaste     | IE5\|N\|O  | 内容将要从浏览者的系统剪贴板传送[粘贴]到页面中时触发的事件   |
| onBeforeUpdate    | IE5\|N\|O  | 当浏览者粘贴系统剪贴板中的内容时通知目标对象                 |
| onContextMenu     | IE5\|N\|O  | 当浏览者按下鼠标右键出现菜单时或者通过键盘的按键触发页面菜单时触发的事件  [试试在页面中的<body>中加入onContentMenu="return false"就可禁止使用鼠标右键了] |
| onCopy            | IE5\|N\|O  | 当页面当前的被选择内容被复制后触发的事件                     |
| onCut             | IE5\|N\|O  | 当页面当前的被选择内容被剪切时触发的事件                     |
| onDrag            | IE5\|N\|O  | 当某个对象被拖动时触发的事件 [活动事件]                      |
| onDragDrop        | IE\|N4\|O  | 一个外部对象被鼠标拖进当前窗口或者帧                         |
| onDragEnd         | IE5\|N\|O  | 当鼠标拖动结束时触发的事件，即鼠标的按钮被释放了             |
| onDragEnter       | IE5\|N\|O  | 当对象被鼠标拖动的对象进入其容器范围内时触发的事件           |
| onDragLeave       | IE5\|N\|O  | 当对象被鼠标拖动的对象离开其容器范围内时触发的事件           |
| onDragOver        | IE5\|N\|O  | 当某被拖动的对象在另一对象容器范围内拖动时触发的事件         |
| onDragStart       | IE4\|N\|O  | 当某对象将被拖动时触发的事件                                 |
| onDrop            | IE5\|N\|O  | 在一个拖动过程中，释放鼠标键时触发的事件                     |
| onLoseCapture     | IE5\|N\|O  | 当元素失去鼠标移动所形成的选择焦点时触发的事件               |
| onPaste           | IE5\|N\|O  | 当内容被粘贴时触发的事件                                     |
| onSelect          | IE4\|N\|O  | 当文本内容被选择时的事件                                     |
| onSelectStart     | IE4\|N\|O  | 当文本内容选择将开始发生时触发的事件                         |


**数据绑定 **

| 事件              | 浏览器支持 | 事件描述                                                     |
| ----------------- | ---------- | ------------------------------------------------------------ |
| onAfterUpdate     | IE4\|N\|O  | 当数据完成由数据源到对象的传送时触发的事件                   |
| onCellChange      | IE5\|N\|O  | 当数据来源发生变化时                                         |
| onDataAvailable   | IE4\|N\|O  | 当数据接收完成时触发事件                                     |
| onDatasetChanged  | IE4\|N\|O  | 数据在数据源发生变化时触发的事件                             |
| onDatasetComplete | IE4\|N\|O  | 当来子数据源的全部有效数据读取完毕时触发的事件               |
| onErrorUpdate     | IE4\|N\|O  | 当使用onBeforeUpdate事件触发取消了数据传送时，代替 onAfterUpdate事件 |
| onRowEnter        | IE5\|N\|O  | 当前数据源的数据发生变化并且有新的有效数据时触发的事件       |
| onRowExit         | IE5\|N\|O  | 当前数据源的数据将要发生变化时触发的事件                     |
| onRowsDelete      | IE5\|N\|O  | 当前数据记录将被删除时触发的事件                             |
| onRowsInserted    | IE5\|N\|O  | 当前数据源将要插入新数据记录时触发的事件                     |

 

**数据绑定**

VUE